<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node-RED Functionãƒãƒ¼ãƒ‰ å®Œå…¨ã‚¬ã‚¤ãƒ‰</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        
        h1 {
            color: #8f0000;
            border-bottom: 3px solid #8f0000;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #c00000;
            margin-top: 30px;
            border-left: 5px solid #c00000;
            padding-left: 15px;
        }
        
        h3 {
            color: #555;
            margin-top: 25px;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .node-example {
            background-color: #2d3133;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            color: white;
            font-family: 'Courier New', monospace;
        }
        
        .node {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 4px;
            margin: 5px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .node-inject {
            background-color: #3fadb5;
            color: white;
        }
        
        .node-function {
            background-color: #e8a658;
            color: white;
        }
        
        .node-debug {
            background-color: #87a48d;
            color: white;
        }
        
        .node-catch {
            background-color: #e87d7d;
            color: white;
        }
        
        .node-change {
            background-color: #e7a070;
            color: white;
        }
        
        .arrow {
            color: #999;
            font-size: 20px;
            margin: 0 10px;
        }
        
        .important {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .tip {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .warning {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            position: relative;
            white-space: pre-wrap;
        }
        
        .js-code {
            background-color: #1e1e1e;
            color: #d4d4d4;
            border: none;
            padding: 15px;
            padding-top: 40px;
            border-radius: 5px;
            position: relative;
            white-space: pre;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .copy-button {
            position: absolute;
            top: 8px;
            right: 8px;
            padding: 6px 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-family: 'Segoe UI', sans-serif;
            transition: background-color 0.2s;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .copy-button:hover {
            background-color: #0056b3;
        }
        
        .copy-button.copied {
            background-color: #28a745;
        }
        
        .copy-button svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }
        
        .exercise {
            background-color: #e8f5e9;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
        }
        
        .exercise h3 {
            color: #2e7d32;
            margin-top: 0;
        }
        
        .difficulty {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .difficulty-easy {
            background-color: #4caf50;
            color: white;
        }
        
        .difficulty-medium {
            background-color: #ff9800;
            color: white;
        }
        
        .difficulty-hard {
            background-color: #f44336;
            color: white;
        }
        
        ul, ol {
            padding-left: 25px;
        }
        
        li {
            margin: 8px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background-color: #e8a658;
            color: white;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .flow-json {
            background-color: #263238;
            color: #aed581;
            padding: 15px;
            padding-top: 40px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            position: relative;
        }
        
        details {
            margin: 15px 0;
        }
        
        summary {
            cursor: pointer;
            padding: 10px;
            background-color: #6c757d;
            color: white;
            border-radius: 4px;
            font-weight: bold;
        }
        
        summary:hover {
            background-color: #5a6268;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .feature-card {
            background-color: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        
        .feature-card h4 {
            color: #e8a658;
            margin-top: 0;
        }
        
        .mode-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-right: 5px;
        }
        
        .badge-basic {
            background-color: #e8a658;
            color: white;
        }
        
        .badge-async {
            background-color: #17a2b8;
            color: white;
        }
        
        .badge-context {
            background-color: #6f42c1;
            color: white;
        }
        
        .badge-error {
            background-color: #dc3545;
            color: white;
        }
        
        .pattern-explanation {
            background-color: #2d3133;
            color: #f8f9fa;
        }
        
        .tab-container {
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 15px 0;
        }
        
        .tab-buttons {
            display: flex;
            background-color: #f1f1f1;
            border-bottom: 1px solid #ddd;
        }
        
        .tab-button {
            padding: 10px 20px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        .tab-button:hover {
            background-color: #ddd;
        }
        
        .tab-button.active {
            background-color: #e8a658;
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 15px;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš¡ Node-RED Functionãƒãƒ¼ãƒ‰ å®Œå…¨ã‚¬ã‚¤ãƒ‰</h1>
        
        <p>ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€Node-REDã®<strong>Functionãƒãƒ¼ãƒ‰</strong>ã«ã¤ã„ã¦ã€åˆå¿ƒè€…ã®æ–¹ã§ã‚‚ç†è§£ã§ãã‚‹ã‚ˆã†ã«è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚</p>
        
        <h2>ğŸ“š 1. Functionãƒãƒ¼ãƒ‰ã¨ã¯?</h2>
        
        <h3>ğŸ¤” ã€ŒFunctionã€ã£ã¦ä½•?</h3>
        <p>
            Functionãƒãƒ¼ãƒ‰ã¯ã€<strong>JavaScriptã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªç”±ã«åŠ å·¥ã§ãã‚‹</strong>ãƒãƒ¼ãƒ‰ã§ã™ã€‚
            æ—¥å¸¸ç”Ÿæ´»ã§ä¾‹ãˆã‚‹ã¨ã€<strong>æ–™ç†äºº</strong>ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚
        </p>
        
        <div class="important">
            <p><strong>ğŸ‘¨â€ğŸ³ æ–™ç†äººã«ä¾‹ãˆã‚‹ã¨:</strong></p>
            <ul>
                <li>ğŸ¥• <strong>ææ–™ã‚’å—ã‘å–ã‚‹</strong> = å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸(msg)</li>
                <li>ğŸ”ª <strong>èª¿ç†ã™ã‚‹(åˆ‡ã‚‹ã€ç…®ã‚‹ã€ç„¼ã)</strong> = JavaScriptã§åŠ å·¥</li>
                <li>ğŸ½ï¸ <strong>æ–™ç†ã‚’æä¾›ã™ã‚‹</strong> = å‡ºåŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™</li>
                <li>ğŸ“‹ <strong>ãƒ¬ã‚·ãƒ”ã‚’è¦šãˆã¦ãŠã</strong> = ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ(å¤‰æ•°ã®ä¿å­˜)</li>
            </ul>
        </div>
        
        <h3>ğŸ“¦ åŸºæœ¬çš„ãªå‹•ä½œ</h3>
        <div class="node-example">
            <span class="node node-inject">Inject</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">Function</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">Debug</span>
        </div>
        
        <p>
            Functionãƒãƒ¼ãƒ‰ã¯ã€å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚Šã€JavaScriptã‚³ãƒ¼ãƒ‰ã§å‡¦ç†ã—ã¦ã€çµæœã‚’å‡ºåŠ›ã—ã¾ã™ã€‚
            <strong>ä»–ã®ãƒãƒ¼ãƒ‰ã§ã¯å®Ÿç¾ã§ããªã„è¤‡é›‘ãªå‡¦ç†</strong>ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚
        </p>
        
        <h2>âš™ï¸ 2. Functionãƒãƒ¼ãƒ‰ã®è¨­å®š</h2>
        
        <h3>ğŸ”§ è¨­å®šã‚¿ãƒ–ã®æ§‹æˆ</h3>
        
        <div class="tab-container">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('tab-setup')">Setup</button>
                <button class="tab-button" onclick="showTab('tab-function')">Function</button>
                <button class="tab-button" onclick="showTab('tab-close')">Close</button>
            </div>
            <div id="tab-setup" class="tab-content active">
                <h4>Setupã‚¿ãƒ–</h4>
                <p>ãƒãƒ¼ãƒ‰ãŒèµ·å‹•ã™ã‚‹ã¨ãã«<strong>1å›ã ã‘å®Ÿè¡Œ</strong>ã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã€‚åˆæœŸåŒ–å‡¦ç†ã«ä½¿ç”¨ã€‚</p>
                <ul>
                    <li>å¤‰æ•°ã®åˆæœŸåŒ–</li>
                    <li>å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ã¸ã®æ¥ç¶š</li>
                    <li>éåŒæœŸå‡¦ç†ã‚‚å¯èƒ½(Promiseã‚’è¿”ã™)</li>
                </ul>
            </div>
            <div id="tab-function" class="tab-content">
                <h4>Functionã‚¿ãƒ–</h4>
                <p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚‹ãŸã³ã«å®Ÿè¡Œã•ã‚Œã‚‹<strong>ãƒ¡ã‚¤ãƒ³ã®ã‚³ãƒ¼ãƒ‰</strong>ã€‚</p>
                <ul>
                    <li>msg.payloadã®åŠ å·¥</li>
                    <li>æ¡ä»¶åˆ†å²</li>
                    <li>ãƒ‡ãƒ¼ã‚¿å¤‰æ›</li>
                </ul>
            </div>
            <div id="tab-close" class="tab-content">
                <h4>Closeã‚¿ãƒ–</h4>
                <p>ãƒãƒ¼ãƒ‰ãŒåœæ­¢ã™ã‚‹ã¨ãã«<strong>1å›ã ã‘å®Ÿè¡Œ</strong>ã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã€‚ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å‡¦ç†ã«ä½¿ç”¨ã€‚</p>
                <ul>
                    <li>ãƒªã‚½ãƒ¼ã‚¹ã®è§£æ”¾</li>
                    <li>ãƒ­ã‚°å‡ºåŠ›</li>
                    <li>çŠ¶æ…‹ã®ä¿å­˜</li>
                </ul>
            </div>
        </div>
        
        <h3>ğŸ“‹ åŸºæœ¬è¨­å®šé …ç›®</h3>
        
        <table>
            <tr>
                <th>è¨­å®šé …ç›®</th>
                <th>èª¬æ˜</th>
                <th>ä¾‹</th>
            </tr>
            <tr>
                <td><strong>Name</strong></td>
                <td>ãƒãƒ¼ãƒ‰ã®è¡¨ç¤ºå</td>
                <td>"ãƒ‡ãƒ¼ã‚¿å¤‰æ›", "ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼"</td>
            </tr>
            <tr>
                <td><strong>Outputs</strong></td>
                <td>å‡ºåŠ›ãƒãƒ¼ãƒˆã®æ•°</td>
                <td>1ã€œè¤‡æ•°(æ¡ä»¶åˆ†å²æ™‚ã«å¢—ã‚„ã™)</td>
            </tr>
            <tr>
                <td><strong>Setup</strong></td>
                <td>åˆæœŸåŒ–ã‚³ãƒ¼ãƒ‰</td>
                <td>context.set('count', 0);</td>
            </tr>
            <tr>
                <td><strong>Function</strong></td>
                <td>ãƒ¡ã‚¤ãƒ³å‡¦ç†ã‚³ãƒ¼ãƒ‰</td>
                <td>msg.payload = ...;</td>
            </tr>
            <tr>
                <td><strong>Close</strong></td>
                <td>çµ‚äº†å‡¦ç†ã‚³ãƒ¼ãƒ‰</td>
                <td>console.log("çµ‚äº†");</td>
            </tr>
        </table>
        
        <h3>ğŸ¯ åˆ©ç”¨å¯èƒ½ãªçµ„ã¿è¾¼ã¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h3>
        
        <div class="feature-grid">
            <div class="feature-card">
                <h4><span class="mode-badge badge-basic">msg</span> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
                <p>å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‚ç…§ãƒ»å¤‰æ›´</p>
                <div class="code-block">msg.payload  // ãƒ‡ãƒ¼ã‚¿æœ¬ä½“
msg.topic    // ãƒˆãƒ”ãƒƒã‚¯å
msg._msgid   // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ID</div>
            </div>
            
            <div class="feature-card">
                <h4><span class="mode-badge badge-context">context</span> ãƒãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</h4>
                <p>ãƒãƒ¼ãƒ‰å†…ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ–</p>
                <div class="code-block">context.get('key')
context.set('key', value)</div>
            </div>
            
            <div class="feature-card">
                <h4><span class="mode-badge badge-context">flow</span> ãƒ•ãƒ­ãƒ¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</h4>
                <p>åŒã˜ãƒ•ãƒ­ãƒ¼å†…ã§å…±æœ‰</p>
                <div class="code-block">flow.get('key')
flow.set('key', value)</div>
            </div>
            
            <div class="feature-card">
                <h4><span class="mode-badge badge-context">global</span> ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</h4>
                <p>å…¨ãƒ•ãƒ­ãƒ¼ã§å…±æœ‰</p>
                <div class="code-block">global.get('key')
global.set('key', value)</div>
            </div>
            
            <div class="feature-card">
                <h4><span class="mode-badge badge-async">node</span> ãƒãƒ¼ãƒ‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h4>
                <p>ãƒãƒ¼ãƒ‰åˆ¶å¾¡ãƒ»ãƒ­ã‚°å‡ºåŠ›</p>
                <div class="code-block">node.send(msg)
node.log("æƒ…å ±")
node.warn("è­¦å‘Š")
node.error("ã‚¨ãƒ©ãƒ¼", msg)
node.status({...})</div>
            </div>
            
            <div class="feature-card">
                <h4><span class="mode-badge badge-basic">env</span> ç’°å¢ƒå¤‰æ•°</h4>
                <p>ç’°å¢ƒå¤‰æ•°ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹</p>
                <div class="code-block">env.get('MY_VAR')</div>
            </div>
        </div>
        
        <h2>ğŸ¯ 3. å®Ÿç”¨çš„ãªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³</h2>
        
        <div class="important">
            <p><strong>ğŸ“¥ ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–¹æ³•:</strong></p>
            <ol>
                <li>ä¸‹ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼JSONã‚’ã‚³ãƒ”ãƒ¼</li>
                <li>Node-REDã‚¨ãƒ‡ã‚£ã‚¿ã§ <strong>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ â†’ èª­ã¿è¾¼ã¿</strong> ã‚’é¸æŠ</li>
                <li>JSONã‚’ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ã€Œèª­ã¿è¾¼ã¿ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            </ol>
            <p>ã“ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã«ã¯ã€ä»¥ä¸‹ã§èª¬æ˜ã™ã‚‹å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿä¾‹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</p>
        </div>
        
        <details>
            <summary>ğŸ“‹ ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>
            <p style="margin: 10px 0; color: #666;"><small>å‚ç…§å…ƒï¼šNodeREDã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼å†…ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼</small></p>
            <div class="flow-json">
[
    {
        "id": "98aa28d4a248e8cb",
        "type": "tab",
        "label": "function",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "ec5a531b.68b65",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "World",
        "payloadType": "str",
        "x": 290,
        "y": 140,
        "wires": [
            [
                "961abba6.04a028"
            ]
        ]
    },
    {
        "id": "1b0f8c3e.1fd7e4",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 140,
        "wires": []
    },
    {
        "id": "4e5bf6b2.b4dd58",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "send a message to output port",
        "info": "Function node can be used to write JavaScript code to handle messages.\nThe input message can be referrenced by `msg` variable.  \nA message returned from body of the function is sent to output port.\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 310,
        "y": 80,
        "wires": []
    },
    {
        "id": "961abba6.04a028",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "return a message",
        "func": "// returning message send it to output port\nmsg.payload = \"Hello, \"+msg.payload +\"!\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 140,
        "wires": [
            [
                "1b0f8c3e.1fd7e4"
            ]
        ]
    },
    {
        "id": "c2b3b0f1.62189",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 280,
        "wires": [
            [
                "7241db1e.8946c4"
            ]
        ]
    },
    {
        "id": "c6191361.0f3c",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 260,
        "wires": []
    },
    {
        "id": "3aa5727c.e5019e",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "send multiple message",
        "info": "Function node can send multiple messages to output ports by returning an array of messages.  \n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 280,
        "y": 220,
        "wires": []
    },
    {
        "id": "7241db1e.8946c4",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "return array of messages",
        "func": "// returning array of message send elements to output ports\nvar msg1 = { payload:\"first out of output 1\" };\nvar msg2 = { payload:\"second out of output 1\" };\nvar msg3 = { payload:\"third out of output 1\" };\nvar msg4 = { payload:\"only message from output 2\" };\nreturn [ [ msg1, msg2, msg3 ], msg4 ];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 510,
        "y": 280,
        "wires": [
            [
                "c6191361.0f3c"
            ],
            [
                "23a53d00.c89b74"
            ]
        ]
    },
    {
        "id": "23a53d00.c89b74",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 300,
        "wires": []
    },
    {
        "id": "cc74476e.cbdf68",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "Hello, World!",
        "payloadType": "str",
        "x": 310,
        "y": 420,
        "wires": [
            [
                "7d90286.706e9d8"
            ]
        ]
    },
    {
        "id": "909906c3.ea9f58",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 420,
        "wires": []
    },
    {
        "id": "d5fc0512.4cd9c8",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "sending messages asynchronously",
        "info": "Function node can asynchronously send a messages to output ports by calling `node.send` function.\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 320,
        "y": 360,
        "wires": []
    },
    {
        "id": "7d90286.706e9d8",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "wait 2s then send message",
        "func": "// setTimeout calls calls specified callback function asynchronously after a specified time\nsetTimeout(function () {\n    node.send(msg);\n}, 2*1000);\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 540,
        "y": 420,
        "wires": [
            [
                "909906c3.ea9f58"
            ]
        ]
    },
    {
        "id": "89c17d21.15da2",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 660,
        "wires": [
            [
                "1bcca7af.619428"
            ]
        ]
    },
    {
        "id": "3b9cd70e.8e66e8",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 660,
        "wires": []
    },
    {
        "id": "f76ea68a.6f3c58",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "handling errors",
        "info": "Calling `node.error` function with the original message as a second argument, function node can trigger a catch node in the same tab.\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 260,
        "y": 600,
        "wires": []
    },
    {
        "id": "1bcca7af.619428",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "report error",
        "func": "// In function node, calling node.error functions with the original input message as its second argument triggers catch node\n// See debug sidebar and console output\nnode.error(\"Oh no, something bad happened\", msg);\n// execution should stops here",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 660,
        "wires": [
            [
                "3b9cd70e.8e66e8"
            ]
        ]
    },
    {
        "id": "74854950.d99558",
        "type": "catch",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "scope": [
            "1bcca7af.619428"
        ],
        "uncaught": false,
        "x": 450,
        "y": 720,
        "wires": [
            [
                "32743f74.e718a"
            ]
        ]
    },
    {
        "id": "32743f74.e718a",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 720,
        "wires": []
    },
    {
        "id": "fb884166.e42f3",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "â†‘ error information can be found in msg.error",
        "info": "",
        "x": 750,
        "y": 760,
        "wires": []
    },
    {
        "id": "64470964.a291a8",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 540,
        "wires": [
            [
                "ee4f5964.5cdae8"
            ]
        ]
    },
    {
        "id": "ed028c2f.924b",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 650,
        "y": 540,
        "wires": []
    },
    {
        "id": "b1686e70.a9f6d",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "logging events",
        "info": "In body of function node code, following logging functions can be used to log events:\n- `node.log`\n- `node.warn`\n- `node.error`\n- `node.trace`\n- `node.debug`\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 260,
        "y": 480,
        "wires": []
    },
    {
        "id": "ee4f5964.5cdae8",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "log events",
        "func": "// In function node, node.log, node.warn, and node.error functions can be used for logging\n// See debug sidebar and console output\nnode.log(\"Something happened\");\nnode.warn(\"Something happened you should know about\");\nnode.error(\"Oh no, something bad happened\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 540,
        "wires": [
            [
                "ed028c2f.924b"
            ]
        ]
    },
    {
        "id": "a3a635eb.191188",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 860,
        "wires": [
            [
                "77f57d92.06fa14"
            ]
        ]
    },
    {
        "id": "1a218bea.61ae04",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 860,
        "wires": []
    },
    {
        "id": "a56bde3a.330e1",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "storing data in context",
        "info": "The function node code can store data in the context store.\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions) and [context store](https://nodered.org/docs/user-guide/context).",
        "x": 280,
        "y": 800,
        "wires": []
    },
    {
        "id": "77f57d92.06fa14",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "counter",
        "func": "// initialise the counter to 0 if it doesn't exist already\nvar count = context.get('count')||0;\ncount += 1;\n// store the value back\ncontext.set('count',count);\n// make it part of the outgoing msg object\nmsg.payload = count;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 460,
        "y": 860,
        "wires": [
            [
                "1a218bea.61ae04"
            ]
        ]
    },
    {
        "id": "ce0b7cca.34817",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "red",
        "payloadType": "str",
        "x": 290,
        "y": 1000,
        "wires": [
            [
                "a4a6c205.8afd4"
            ]
        ]
    },
    {
        "id": "c98c52d0.ab51f",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "showing status information",
        "info": "The function node code can provide status decoration by calling `node.status` function.\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 290,
        "y": 940,
        "wires": []
    },
    {
        "id": "a4a6c205.8afd4",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "show status",
        "func": "// calling node.status show status information below the function node\nswitch (msg.payload) {\n    case \"red\":\n        node.status({fill:\"red\",shape:\"ring\",text:\"disconnected\"});\n        break;\n    case \"green\":\n        node.status({fill:\"green\",shape:\"dot\",text:\"connected\"});\n        break;\n    case \"text\":\n        node.status({text:\"Just text status\"});\n        break;\n    case \"clear\":\n        node.status({});   // to clear the status    \n        break;\n}\n\n",
        "outputs": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 1000,
        "wires": []
    },
    {
        "id": "9f29ae74.8dd11",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "green",
        "payloadType": "str",
        "x": 290,
        "y": 1040,
        "wires": [
            [
                "a4a6c205.8afd4"
            ]
        ]
    },
    {
        "id": "83fc1404.ec0b98",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "text",
        "payloadType": "str",
        "x": 290,
        "y": 1080,
        "wires": [
            [
                "a4a6c205.8afd4"
            ]
        ]
    },
    {
        "id": "517a869c.0ceab8",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "clear",
        "payloadType": "str",
        "x": 290,
        "y": 1120,
        "wires": [
            [
                "a4a6c205.8afd4"
            ]
        ]
    },
    {
        "id": "3ece1efd.306c22",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 380,
        "y": 1240,
        "wires": [
            [
                "c9100743.673598"
            ]
        ]
    },
    {
        "id": "ed3da95d.62ee98",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 1240,
        "wires": []
    },
    {
        "id": "85b5b8ad.0717d8",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "using external modules (needs change in settings.js)",
        "info": "The function node can use external node modules using global context value.\n\nAdditional node modules must be loaded in `settings.js` file and added to the `functionGlobalContext` property.  \n\nFor example, following definition in `settings.js` load `os` module on start up of Node-RED.  \n\n```\nfunctionGlobalContext: {\n    os: require(\"os\")\n}\n```\n\nThe `os` module can be accessed in a function blocks as:\n```\nglobal.get(\"os\")\n```\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions) and [context store](https://nodered.org/docs/user-guide/context).",
        "x": 520,
        "y": 1180,
        "wires": []
    },
    {
        "id": "c9100743.673598",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "use os module",
        "func": "// use external os module to access OS information\nvar os = global.get(\"os\");\nmsg.payload = { \n    hostname: os.hostname(),\n    arch: os.arch(),\n    platform: os.platform(),\n    release: os.release(),\n    free: os.freemem()\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 560,
        "y": 1240,
        "wires": [
            [
                "ed3da95d.62ee98"
            ]
        ]
    },
    {
        "id": "e397736b.a96af",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 1380,
        "wires": [
            [
                "900ad01c.561f"
            ]
        ]
    },
    {
        "id": "1e2a78d6.33f617",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 1380,
        "wires": []
    },
    {
        "id": "83d3f2fd.593b4",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "setup and close",
        "info": "The function node code provide setup and closecode.  \nThe `Setup` tab contains code that will be run whenever the node is started. The `Close` tab contains code that will be run when the node is stopped.\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 260,
        "y": 1320,
        "wires": []
    },
    {
        "id": "900ad01c.561f",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "counter",
        "func": "// get value of global counter\nvar count = global.get('count');\ncount += 1;\n// store the value back\nglobal.set('count',count);\n// make it part of the outgoing msg object\nmsg.payload = count;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// initialize global counter\nglobal.set('count', 0);",
        "finalize": "// report current counter to console\nvar count = global.get('count');\nconsole.log(\"count:\", count);",
        "x": 460,
        "y": 1380,
        "wires": [
            [
                "1e2a78d6.33f617"
            ]
        ]
    },
    {
        "id": "89904b80.4fcd08",
        "type": "inject",
        "z": "98aa28d4a248e8cb",
        "d": true,
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 310,
        "y": 1520,
        "wires": [
            [
                "22c235a0.acb41a"
            ]
        ]
    },
    {
        "id": "20fa70dc.7107f",
        "type": "debug",
        "z": "98aa28d4a248e8cb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 1520,
        "wires": []
    },
    {
        "id": "cddf88c9.9df018",
        "type": "comment",
        "z": "98aa28d4a248e8cb",
        "name": "asynchronous setup",
        "info": "The `Setup` code that performs asynchronous work can return a promise object of the work.  The completion of the promise is waited before starting function body.\n\nSee Node-RED user guide about [functions](https://nodered.org/docs/user-guide/writing-functions).",
        "x": 270,
        "y": 1460,
        "wires": []
    },
    {
        "id": "22c235a0.acb41a",
        "type": "function",
        "z": "98aa28d4a248e8cb",
        "name": "async. setup",
        "func": "// retrieve message value\nmsg.payload = global.get('message');\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// set initial value of message\nglobal.set(\"message\", \"Initializing, World!\");\n// create promise for async work\nvar promise = new Promise((resolve, reject) => {\n    // async work: wait 1s, then set message\n    setTimeout(() => {\n        global.set(\"message\", \"Hello, World!\");\n        // report this work successfuly ended\n        resolve();\n    }, 1000);\n});\n// return the promise that should be executed before function code\nreturn promise;",
        "finalize": "",
        "x": 490,
        "y": 1520,
        "wires": [
            [
                "20fa70dc.7107f"
            ]
        ]
    }
]
            </div>
        </details>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³1: åŸºæœ¬çš„ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åŠ å·¥</h3>
        <p><strong>ç”¨é€”:</strong> å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’åŠ å·¥ã—ã¦å‡ºåŠ›ã™ã‚‹æœ€ã‚‚åŸºæœ¬çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³</p>
        
        <div class="node-example">
            <span class="node node-inject">Inject</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">Function</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">Debug</span>
        </div>
        
        <div class="tip">
            <p><strong>ğŸ“Œ å‹•ä½œã®æµã‚Œ:</strong></p>
            <ol>
                <li>Injectãƒãƒ¼ãƒ‰ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡</li>
                <li>Functionãƒãƒ¼ãƒ‰ã§ <code>msg.payload</code> ã‚’åŠ å·¥</li>
                <li><code>return msg;</code> ã§æ¬¡ã®ãƒãƒ¼ãƒ‰ã«é€ä¿¡</li>
            </ol>
        </div>
        
        <p><strong>ã‚³ãƒ¼ãƒ‰ä¾‹:</strong></p>
        <div class="js-code" data-copy="true">// å…¥åŠ›å€¤ã«æŒ¨æ‹¶ã‚’è¿½åŠ ã™ã‚‹

msg.payload = "Hello, " + msg.payload + "!";

return msg;</div>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³2: è¤‡æ•°å‡ºåŠ›ã¸ã®æŒ¯ã‚Šåˆ†ã‘</h3>
        <p><strong>ç”¨é€”:</strong> æ¡ä»¶ã«å¿œã˜ã¦ç•°ãªã‚‹å‡ºåŠ›ãƒãƒ¼ãƒˆã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡</p>
        
        <div class="node-example">
            <span class="node node-inject">Inject</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">Function<br><small>(2å‡ºåŠ›)</small></span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">Debug 1</span>
            <br><br>
            <span style="margin-left: 232px;" class="arrow">â†’</span>
            <span class="node node-debug">Debug 2</span>
        </div>
        
        <div class="tip">
            <p><strong>ğŸ“Œ æˆ»ã‚Šå€¤ã®å½¢å¼:</strong></p>
            <ul>
                <li><code>[msg, null]</code> â†’ å‡ºåŠ›1ã®ã¿ã«é€ä¿¡</li>
                <li><code>[null, msg]</code> â†’ å‡ºåŠ›2ã®ã¿ã«é€ä¿¡</li>
                <li><code>[msg1, msg2]</code> â†’ ä¸¡æ–¹ã«é€ä¿¡</li>
            </ul>
        </div>
        
        <p><strong>ã‚³ãƒ¼ãƒ‰ä¾‹:</strong></p>
        <div class="js-code" data-copy="true">// æ•°å€¤ãŒ50ä»¥ä¸Šãªã‚‰å‡ºåŠ›1ã€æœªæº€ãªã‚‰å‡ºåŠ›2ã«æŒ¯ã‚Šåˆ†ã‘

if (msg.payload >= 50) {
    return [msg, null];
} else {
    return [null, msg];
}</div>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³3: è¤‡æ•°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡</h3>
        <p><strong>ç”¨é€”:</strong> 1ã¤ã®å…¥åŠ›ã‹ã‚‰è¤‡æ•°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ</p>
        
        <div class="node-example">
            <span class="node node-inject">Inject<br><small>(1å›)</small></span>
            <span class="arrow">â†’</span>
            <span class="node node-function">Function</span>
            <span class="arrow">â†’â†’â†’</span>
            <span class="node node-debug">Debug<br><small>(3å›å—ä¿¡)</small></span>
        </div>
        
        <div class="tip">
            <p><strong>ğŸ“Œ æˆ»ã‚Šå€¤ã®å½¢å¼:</strong></p>
            <ul>
                <li><code>[[msg1, msg2, msg3]]</code> â†’ å‡ºåŠ›1ã«3ã¤ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é †æ¬¡é€ä¿¡</li>
                <li><code>[[msg1, msg2], [msg3]]</code> â†’ å‡ºåŠ›1ã«2ã¤ã€å‡ºåŠ›2ã«1ã¤</li>
            </ul>
        </div>
        
        <p><strong>ã‚³ãƒ¼ãƒ‰ä¾‹:</strong></p>
        <div class="js-code" data-copy="true">// 3ã¤ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é †æ¬¡é€ä¿¡

var msg1 = { payload: "first" };
var msg2 = { payload: "second" };
var msg3 = { payload: "third" };

return [[msg1, msg2, msg3]];</div>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³4: éåŒæœŸå‡¦ç†</h3>
        <p><strong>ç”¨é€”:</strong> setTimeoutã€APIå‘¼ã³å‡ºã—ç­‰ã®éåŒæœŸå‡¦ç†å¾Œã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡</p>
        
        <div class="node-example">
            <span class="node node-inject">Inject</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">Function<br><small>(2ç§’å¾…æ©Ÿ)</small></span>
            <span class="arrow">â‹¯â†’</span>
            <span class="node node-debug">Debug</span>
        </div>
        
        <div class="tip">
            <p><strong>ğŸ“Œ å‹•ä½œã®æµã‚Œ:</strong></p>
            <ol>
                <li>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡</li>
                <li><code>setTimeout()</code> ã§é…å»¶å®Ÿè¡Œã‚’è¨­å®š</li>
                <li><code>return</code> ã¯ä¸è¦ï¼ˆä½•ã‚‚è¿”ã•ãªã„ï¼‰</li>
                <li>å‡¦ç†å®Œäº†å¾Œã€<code>node.send(msg)</code> ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡</li>
            </ol>
        </div>
        
        <p><strong>ã‚³ãƒ¼ãƒ‰ä¾‹:</strong></p>
        <div class="js-code" data-copy="true">// 2ç§’å¾Œã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡

setTimeout(function() {
    node.send(msg);
}, 2000);

// æ³¨æ„: éåŒæœŸå‡¦ç†ã§ã¯ return ã—ãªã„</div>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³5: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜</h3>
        <p><strong>ç”¨é€”:</strong> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹(ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã€çŠ¶æ…‹ç®¡ç†ãªã©)</p>
        
        <div class="node-example">
            <span class="node node-inject">Inject<br><small>(è¤‡æ•°å›)</small></span>
            <span class="arrow">â†’</span>
            <span class="node node-function">Function<br><small>(ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼)</small></span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">Debug<br><small>(1, 2, 3...)</small></span>
        </div>
        
        <div class="tip">
            <p><strong>ğŸ“Œ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ç¨®é¡:</strong></p>
            <ul>
                <li><code>context</code> â†’ ã“ã®ãƒãƒ¼ãƒ‰å†…ã®ã¿</li>
                <li><code>flow</code> â†’ åŒã˜ãƒ•ãƒ­ãƒ¼(ã‚¿ãƒ–)å†…ã§å…±æœ‰</li>
                <li><code>global</code> â†’ å…¨ãƒ•ãƒ­ãƒ¼ã§å…±æœ‰</li>
            </ul>
        </div>
        
        <p><strong>ã‚³ãƒ¼ãƒ‰ä¾‹:</strong></p>
        <div class="js-code" data-copy="true">// ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼: 0ã‹ã‚‰å§‹ã‚ã¦1ãšã¤å¢—åŠ 

var count = context.get('count') || 0;
count += 1;
context.set('count', count);

msg.payload = count;

return msg;</div>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³6: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º</h3>
        <p><strong>ç”¨é€”:</strong> ãƒãƒ¼ãƒ‰ã®ä¸‹ã«çŠ¶æ…‹ã‚’è¡¨ç¤ºã—ã¦å¯è¦–åŒ–</p>
        
        <div class="node-example">
            <span class="node node-inject">Inject</span>
            <span class="arrow">â†’</span>
            <span class="node node-function" style="position: relative;">Function<br>
                <small style="display: block; margin-top: 5px; padding: 2px 6px; background: #4caf50; border-radius: 3px; font-size: 10px;">â— æ¥ç¶šä¸­</small>
            </span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">Debug</span>
        </div>
        
        <div class="tip">
            <p><strong>ğŸ“Œ node.status() ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³:</strong></p>
            <ul>
                <li><code>fill</code>: "red", "green", "yellow", "blue", "grey"</li>
                <li><code>shape</code>: "ring"(è¼ª), "dot"(ç‚¹)</li>
                <li><code>text</code>: è¡¨ç¤ºã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ</li>
            </ul>
        </div>
        
        <p><strong>ã‚³ãƒ¼ãƒ‰ä¾‹:</strong></p>
        <div class="js-code" data-copy="true">// æ¥ç¶šçŠ¶æ…‹ã‚’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§è¡¨ç¤º

if (msg.payload === "connected") {
    node.status({
        fill: "green",
        shape: "dot",
        text: "æ¥ç¶šä¸­"
    });
} else {
    node.status({
        fill: "red",
        shape: "ring",
        text: "åˆ‡æ–­"
    });
}</div>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³7: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</h3>
        <p><strong>ç”¨é€”:</strong> ã‚¨ãƒ©ãƒ¼ã‚’é©åˆ‡ã«å‡¦ç†ã—ã€Catchãƒãƒ¼ãƒ‰ã§æ•æ‰ã™ã‚‹</p>
        
        <div class="node-example">
            <span class="node node-inject">Inject</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">Function</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">Debug</span>
            <br><br>
            <span style="margin-left: 155px;" class="node node-catch">Catch</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">Error Debug</span>
        </div>
        
        <div class="tip">
            <p><strong>ğŸ“Œ ã‚¨ãƒ©ãƒ¼å ±å‘Šã®ç¨®é¡:</strong></p>
            <ul>
                <li><code>node.error("message")</code> â†’ ãƒ­ã‚°ã«ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã®ã¿</li>
                <li><code>node.error("message", msg)</code> â†’ Catchãƒãƒ¼ãƒ‰ã§ã‚­ãƒ£ãƒƒãƒå¯èƒ½</li>
            </ul>
            <p><em>â€» ç¬¬2å¼•æ•°ã«msgã‚’æ¸¡ã™ã¨Catchãƒãƒ¼ãƒ‰ãŒå—ã‘å–ã‚Œã‚‹</em></p>
        </div>
        
        <p><strong>ã‚³ãƒ¼ãƒ‰ä¾‹:</strong></p>
        <div class="js-code" data-copy="true">// å…¥åŠ›å€¤ã®æ¤œè¨¼ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç†

if (typeof msg.payload !== "number") {
    node.error("æ•°å€¤ã§ã¯ã‚ã‚Šã¾ã›ã‚“", msg);
    return null;
}

msg.payload = msg.payload * 2;

return msg;</div>
        
        <div class="tip">
            <h3>ğŸ’¡ ãƒ’ãƒ³ãƒˆ: ãƒ­ã‚°å‡ºåŠ›é–¢æ•°ã®ä½¿ã„åˆ†ã‘</h3>
            <table>
                <tr>
                    <th>é–¢æ•°</th>
                    <th>ç”¨é€”</th>
                    <th>ãƒ‡ãƒãƒƒã‚°ã‚µã‚¤ãƒ‰ãƒãƒ¼</th>
                </tr>
                <tr>
                    <td><code>node.log()</code></td>
                    <td>ä¸€èˆ¬çš„ãªæƒ…å ±</td>
                    <td>è¡¨ç¤ºã•ã‚Œãªã„</td>
                </tr>
                <tr>
                    <td><code>node.warn()</code></td>
                    <td>è­¦å‘Š</td>
                    <td>è¡¨ç¤ºã•ã‚Œã‚‹</td>
                </tr>
                <tr>
                    <td><code>node.error()</code></td>
                    <td>ã‚¨ãƒ©ãƒ¼</td>
                    <td>è¡¨ç¤ºã•ã‚Œã‚‹</td>
                </tr>
                <tr>
                    <td><code>node.trace()</code></td>
                    <td>è©³ç´°ãªãƒˆãƒ¬ãƒ¼ã‚¹</td>
                    <td>è¨­å®šã«ã‚ˆã‚‹</td>
                </tr>
                <tr>
                    <td><code>node.debug()</code></td>
                    <td>ãƒ‡ãƒãƒƒã‚°æƒ…å ±</td>
                    <td>è¨­å®šã«ã‚ˆã‚‹</td>
                </tr>
            </table>
        </div>
        
        <h2>ğŸ‹ï¸ 4. å®Ÿè·µæ¼”ç¿’</h2>
        
        <div class="exercise">
            <h3>æ¼”ç¿’1: åŸºæœ¬çš„ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åŠ å·¥<span class="difficulty difficulty-easy">åˆç´š</span></h3>
            
            <p><strong>ğŸ“ èª²é¡Œ:</strong></p>
            <p>åå‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ŒHello, [åå‰]!ã€ã¨æŒ¨æ‹¶ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li>Injectã€Functionã€Debugãƒãƒ¼ãƒ‰ã‚’ä½¿ç”¨</li>
                <li>å…¥åŠ›: "World" â†’ å‡ºåŠ›: "Hello, World!"</li>
            </ul>
            
            <p><strong>ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:</strong></p>
            <ul>
                <li>Injectãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ Debugã« "Hello, World!" ãŒè¡¨ç¤º</li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>Functionãƒãƒ¼ãƒ‰ã®åŸºæœ¬æ§‹é€ :</strong></p>
                <ul>
                    <li><code>msg.payload</code>ã§å…¥åŠ›å€¤ã‚’å–å¾—</li>
                    <li>æ–‡å­—åˆ—çµåˆã¯ <code>+</code> æ¼”ç®—å­ã‚’ä½¿ç”¨</li>
                    <li><code>return msg;</code> ã§çµæœã‚’å‡ºåŠ›</li>
                </ul>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">
[
    {
        "id": "ex1_inject",
        "type": "inject",
        "name": "åå‰å…¥åŠ›",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "World",
        "payloadType": "str",
        "x": 120,
        "y": 100,
        "wires": [["ex1_function"]]
    },
    {
        "id": "ex1_function",
        "type": "function",
        "name": "æŒ¨æ‹¶ç”Ÿæˆ",
        "func": "// å…¥åŠ›å€¤ã«æŒ¨æ‹¶ã‚’è¿½åŠ ã™ã‚‹\nmsg.payload = \"Hello, \" + msg.payload + \"!\";\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 290,
        "y": 100,
        "wires": [["ex1_debug"]]
    },
    {
        "id": "ex1_debug",
        "type": "debug",
        "name": "çµæœ",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 450,
        "y": 100,
        "wires": []
    }
]
                </div>
            </details>
        </div>
        
        <div class="exercise">
            <h3>æ¼”ç¿’2: ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ©Ÿèƒ½<span class="difficulty difficulty-medium">ä¸­ç´š</span></h3>
            
            <p><strong>ğŸ“ èª²é¡Œ:</strong></p>
            <p>ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ãŸã³ã«ã‚«ã‚¦ãƒ³ãƒˆãŒ1ãšã¤å¢—åŠ ã™ã‚‹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li>Injectã€Functionã€Debugãƒãƒ¼ãƒ‰ã‚’ä½¿ç”¨</li>
                <li>contextã‚’ä½¿ç”¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¿æŒ</li>
                <li>ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ãŸã³ã«1, 2, 3...ã¨å¢—åŠ </li>
            </ul>
            
            <p><strong>ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:</strong></p>
            <ul>
                <li>1å›ç›®ã‚¯ãƒªãƒƒã‚¯ â†’ 1</li>
                <li>2å›ç›®ã‚¯ãƒªãƒƒã‚¯ â†’ 2</li>
                <li>3å›ç›®ã‚¯ãƒªãƒƒã‚¯ â†’ 3</li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>contextã®ä½¿ã„æ–¹:</strong></p>
                <ul>
                    <li><code>context.get('count')</code>ã§å€¤ã‚’å–å¾—</li>
                    <li>å€¤ãŒãªã„å ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: <code>|| 0</code></li>
                    <li><code>context.set('count', value)</code>ã§å€¤ã‚’ä¿å­˜</li>
                </ul>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">
[
    {
        "id": "ex2_inject",
        "type": "inject",
        "name": "ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 100,
        "wires": [["ex2_function"]]
    },
    {
        "id": "ex2_function",
        "type": "function",
        "name": "ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼",
        "func": "// ç¾åœ¨ã®ã‚«ã‚¦ãƒ³ãƒˆå€¤ã‚’å–å¾—ï¼ˆæœªå®šç¾©ãªã‚‰0ï¼‰\nvar count = context.get('count') || 0;\n\n// ã‚«ã‚¦ãƒ³ãƒˆã‚’1å¢—åŠ \ncount += 1;\n\n// å€¤ã‚’ä¿å­˜\ncontext.set('count', count);\n\n// å‡ºåŠ›\nmsg.payload = count;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 310,
        "y": 100,
        "wires": [["ex2_debug"]]
    },
    {
        "id": "ex2_debug",
        "type": "debug",
        "name": "ã‚«ã‚¦ãƒ³ãƒˆå€¤",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 490,
        "y": 100,
        "wires": []
    }
]
                </div>
            </details>
        </div>
        
        <div class="exercise">
            <h3>æ¼”ç¿’3: æ¡ä»¶åˆ†å²ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º<span class="difficulty difficulty-medium">ä¸­ç´š</span></h3>
            
            <p><strong>ğŸ“ èª²é¡Œ:</strong></p>
            <p>æ¸©åº¦ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€30åº¦ä»¥ä¸Šãªã‚‰ã€Œé«˜æ¸©ã€ã€10åº¦ä»¥ä¸‹ãªã‚‰ã€Œä½æ¸©ã€ã€ãã‚Œä»¥å¤–ã¯ã€Œé©æ¸©ã€ã¨åˆ¤å®šã—ã€ãƒãƒ¼ãƒ‰ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤ºã—ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li>Injectãƒãƒ¼ãƒ‰ã§æ•°å€¤ã‚’å…¥åŠ›(10, 25, 35ãªã©)</li>
                <li>Functionãƒãƒ¼ãƒ‰ã§æ¸©åº¦ã‚’åˆ¤å®š</li>
                <li>node.status()ã§ãƒãƒ¼ãƒ‰ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤º</li>
                <li>30åº¦ä»¥ä¸Š: èµ¤è‰²ã€10åº¦ä»¥ä¸‹: é’è‰²ã€ãã‚Œä»¥å¤–: ç·‘è‰²</li>
            </ul>
            
            <p><strong>ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:</strong></p>
            <ul>
                <li>35ã‚’å…¥åŠ› â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«èµ¤ã§ã€Œé«˜æ¸©: 35â„ƒã€</li>
                <li>5ã‚’å…¥åŠ› â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«é’ã§ã€Œä½æ¸©: 5â„ƒã€</li>
                <li>25ã‚’å…¥åŠ› â†’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«ç·‘ã§ã€Œé©æ¸©: 25â„ƒã€</li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>node.status()ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³:</strong></p>
                <ul>
                    <li>fill: "red", "blue", "green"</li>
                    <li>shape: "dot"(å¡—ã‚Šã¤ã¶ã—)ã¾ãŸã¯"ring"(è¼ª)</li>
                    <li>text: è¡¨ç¤ºã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ</li>
                </ul>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">
[
    {
        "id": "ex3_inject_hot",
        "type": "inject",
        "name": "35åº¦(é«˜æ¸©)",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "35",
        "payloadType": "num",
        "x": 130,
        "y": 80,
        "wires": [["ex3_function"]]
    },
    {
        "id": "ex3_inject_normal",
        "type": "inject",
        "name": "25åº¦(é©æ¸©)",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "25",
        "payloadType": "num",
        "x": 130,
        "y": 120,
        "wires": [["ex3_function"]]
    },
    {
        "id": "ex3_inject_cold",
        "type": "inject",
        "name": "5åº¦(ä½æ¸©)",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "5",
        "payloadType": "num",
        "x": 130,
        "y": 160,
        "wires": [["ex3_function"]]
    },
    {
        "id": "ex3_function",
        "type": "function",
        "name": "æ¸©åº¦åˆ¤å®š",
        "func": "// æ¸©åº¦ã‚’å–å¾—\nvar temp = msg.payload;\nvar status = {};\n\n// æ¸©åº¦ã«å¿œã˜ã¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¨­å®š\nif (temp >= 30) {\n    status = {\n        fill: \"red\",\n        shape: \"dot\",\n        text: \"é«˜æ¸©: \" + temp + \"â„ƒ\"\n    };\n    msg.payload = \"é«˜æ¸©\";\n} else if (temp <= 10) {\n    status = {\n        fill: \"blue\",\n        shape: \"dot\",\n        text: \"ä½æ¸©: \" + temp + \"â„ƒ\"\n    };\n    msg.payload = \"ä½æ¸©\";\n} else {\n    status = {\n        fill: \"green\",\n        shape: \"dot\",\n        text: \"é©æ¸©: \" + temp + \"â„ƒ\"\n    };\n    msg.payload = \"é©æ¸©\";\n}\n\n// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤º\nnode.status(status);\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 330,
        "y": 120,
        "wires": [["ex3_debug"]]
    },
    {
        "id": "ex3_debug",
        "type": "debug",
        "name": "åˆ¤å®šçµæœ",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 510,
        "y": 120,
        "wires": []
    }
]
                </div>
            </details>
        </div>
        
        <div class="exercise">
            <h3>æ¼”ç¿’4: éåŒæœŸå‡¦ç†ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°<span class="difficulty difficulty-hard">ä¸Šç´š</span></h3>
            
            <p><strong>ğŸ“ èª²é¡Œ:</strong></p>
            <p>ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€2ç§’å¾Œã«ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¦é€ä¿¡ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ãŸã ã—ã€ãƒ‡ãƒ¼ã‚¿ãŒä¸æ­£ãªå ´åˆã¯ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ã€Catchãƒãƒ¼ãƒ‰ã§æ•æ‰ã—ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li>Injectã€Functionã€Debugã€Catchãƒãƒ¼ãƒ‰ã‚’ä½¿ç”¨</li>
                <li>æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã¯2ç§’å¾Œã«2å€ã«ã—ã¦å‡ºåŠ›</li>
                <li>æ•°å€¤ä»¥å¤–ã®å ´åˆã¯node.error()ã§ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿ</li>
                <li>Catchãƒãƒ¼ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ã‚’æ•æ‰ã—ã¦Debugã«å‡ºåŠ›</li>
            </ul>
            
            <p><strong>ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:</strong></p>
            <ul>
                <li>50ã‚’å…¥åŠ› â†’ 2ç§’å¾Œã«100ãŒå‡ºåŠ›</li>
                <li>"text"ã‚’å…¥åŠ› â†’ Catchãƒãƒ¼ãƒ‰ã§ã‚¨ãƒ©ãƒ¼æ•æ‰</li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>éåŒæœŸå‡¦ç†ã¨ã‚¨ãƒ©ãƒ¼ã®çµ„ã¿åˆã‚ã›:</strong></p>
                <ul>
                    <li><code>typeof msg.payload === "number"</code>ã§å‹ãƒã‚§ãƒƒã‚¯</li>
                    <li><code>setTimeout()</code>ã§é…å»¶å‡¦ç†</li>
                    <li><code>node.error("message", msg)</code>ã§Catchãƒãƒ¼ãƒ‰ã«é€ä¿¡</li>
                    <li>ã‚¨ãƒ©ãƒ¼æ™‚ã¯<code>return null;</code>ã§å‡¦ç†ã‚’çµ‚äº†</li>
                </ul>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">
[
    {
        "id": "ex4_inject_num",
        "type": "inject",
        "name": "æ•°å€¤(50)",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "50",
        "payloadType": "num",
        "x": 120,
        "y": 80,
        "wires": [["ex4_function"]]
    },
    {
        "id": "ex4_inject_str",
        "type": "inject",
        "name": "æ–‡å­—åˆ—(error)",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "error",
        "payloadType": "str",
        "x": 130,
        "y": 120,
        "wires": [["ex4_function"]]
    },
    {
        "id": "ex4_function",
        "type": "function",
        "name": "éåŒæœŸå‡¦ç†",
        "func": "// å…¥åŠ›å€¤ã®å‹ãƒã‚§ãƒƒã‚¯\nif (typeof msg.payload !== \"number\") {\n    node.error(\"æ•°å€¤ã§ã¯ã‚ã‚Šã¾ã›ã‚“: \" + msg.payload, msg);\n    return null;\n}\n\n// 2ç§’å¾Œã«å‡¦ç†ã‚’å®Ÿè¡Œ\nvar value = msg.payload;\nsetTimeout(function() {\n    msg.payload = value * 2;\n    node.send(msg);\n}, 2000);\n\n// éåŒæœŸå‡¦ç†ãªã®ã§returnã—ãªã„",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 330,
        "y": 100,
        "wires": [["ex4_debug"]]
    },
    {
        "id": "ex4_debug",
        "type": "debug",
        "name": "å‡¦ç†çµæœ",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 530,
        "y": 80,
        "wires": []
    },
    {
        "id": "ex4_catch",
        "type": "catch",
        "name": "ã‚¨ãƒ©ãƒ¼æ•æ‰",
        "scope": ["ex4_function"],
        "uncaught": false,
        "x": 330,
        "y": 160,
        "wires": [["ex4_error_debug"]]
    },
    {
        "id": "ex4_error_debug",
        "type": "debug",
        "name": "ã‚¨ãƒ©ãƒ¼æƒ…å ±",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 530,
        "y": 160,
        "wires": []
    }
]
                </div>
            </details>
        </div>
        
        <h2>ğŸ“ 5. ã¾ã¨ã‚</h2>
        
        <div class="important">
            <h3>Functionãƒãƒ¼ãƒ‰ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h3>
            <ul>
                <li>âœ… <strong>åŸºæœ¬æ§‹é€ </strong>: msg.payloadã‚’åŠ å·¥ã—ã€return msgã§å‡ºåŠ›</li>
                <li>âœ… <strong>è¤‡æ•°å‡ºåŠ›</strong>: é…åˆ—ã§è¿”ã—ã¦å‡ºåŠ›ã‚’æŒ¯ã‚Šåˆ†ã‘</li>
                <li>âœ… <strong>éåŒæœŸå‡¦ç†</strong>: node.send()ã§ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’åˆ¶å¾¡</li>
                <li>âœ… <strong>ãƒ‡ãƒ¼ã‚¿ä¿å­˜</strong>: context/flow/globalã§çŠ¶æ…‹ã‚’ä¿æŒ</li>
                <li>âœ… <strong>ã‚¨ãƒ©ãƒ¼å‡¦ç†</strong>: node.error(msg, originalMsg)ã§Catchãƒãƒ¼ãƒ‰ã¨é€£æº</li>
                <li>âœ… <strong>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º</strong>: node.status()ã§è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</li>
            </ul>
        </div>
        
        <div class="warning">
            <h3>âš ï¸ ã‚ˆãã‚ã‚‹é–“é•ã„</h3>
            <ul>
                <li><strong>returnå¿˜ã‚Œ</strong>: returnã—ãªã„ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚Œãªã„</li>
                <li><strong>éåŒæœŸã§return</strong>: setTimeoutå†…ã§ã¯node.send()ã‚’ä½¿ã†</li>
                <li><strong>msgä¸Šæ›¸ã</strong>: æ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹å ´åˆã¯<code>{ payload: "..." }</code></li>
                <li><strong>contextã®åˆæœŸåŒ–å¿˜ã‚Œ</strong>: <code>|| ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤</code>ã§å¯¾å‡¦</li>
            </ul>
        </div>
        
        <div class="tip">
            <h3>ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
            <p>Functionãƒãƒ¼ãƒ‰ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ãƒãƒ¼ãƒ‰ã‚‚å­¦ã‚“ã§ã¿ã¾ã—ã‚‡ã†:</p>
            <ul>
                <li><strong>Changeãƒãƒ¼ãƒ‰</strong>: ã‚³ãƒ¼ãƒ‰ãªã—ã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å¤‰æ›´</li>
                <li><strong>Switchãƒãƒ¼ãƒ‰</strong>: æ¡ä»¶åˆ†å²ã‚’GUIã§è¨­å®š</li>
                <li><strong>Templateãƒãƒ¼ãƒ‰</strong>: Mustacheæ§‹æ–‡ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ</li>
                <li><strong>Joinãƒãƒ¼ãƒ‰</strong>: è¤‡æ•°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çµåˆ</li>
            </ul>
        </div>
        
        <h2>ğŸ”§ 6. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
        
        <h3>ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•</h3>
        
        <table>
            <tr>
                <th>å•é¡Œ</th>
                <th>åŸå› </th>
                <th>è§£æ±ºæ–¹æ³•</th>
            </tr>
            <tr>
                <td>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºåŠ›ã•ã‚Œãªã„</td>
                <td>returnæ–‡ãŒãªã„</td>
                <td>ã‚³ãƒ¼ãƒ‰ã®æœ€å¾Œã«<code>return msg;</code>ã‚’è¿½åŠ </td>
            </tr>
            <tr>
                <td>éåŒæœŸå‡¦ç†å¾Œã«å‡ºåŠ›ã•ã‚Œãªã„</td>
                <td>returnã‚’ä½¿ã£ã¦ã„ã‚‹</td>
                <td><code>node.send(msg);</code>ã«å¤‰æ›´</td>
            </tr>
            <tr>
                <td>ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹</td>
                <td>ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã‚’ä½¿ç”¨</td>
                <td><code>context.set/get</code>ã‚’ä½¿ç”¨</td>
            </tr>
            <tr>
                <td>ã‚¨ãƒ©ãƒ¼ãŒCatchã§æ•æ‰ã•ã‚Œãªã„</td>
                <td>ç¬¬2å¼•æ•°ãŒãªã„</td>
                <td><code>node.error("msg", msg)</code>ã¨è¨˜è¿°</td>
            </tr>
            <tr>
                <td>JSONã®ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼</td>
                <td>æ–‡å­—åˆ—ãŒJSONå½¢å¼ã§ãªã„</td>
                <td>try-catchã§å›²ã‚€</td>
            </tr>
            <tr>
                <td>å¤–éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒä½¿ãˆãªã„</td>
                <td>settings.jsã®è¨­å®šä¸è¶³</td>
                <td>functionGlobalContextã«è¿½åŠ </td>
            </tr>
        </table>
        
        <h2>ğŸ’¡ 7. å®Ÿå‹™ã§ã®æ´»ç”¨ä¾‹</h2>
        
        <h3>ã‚±ãƒ¼ã‚¹1: ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›</h3>
        <div class="js-code" data-copy="true">// æ¸©åº¦ã‚»ãƒ³ã‚µãƒ¼ã®ç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’æ‘‚æ°ã«å¤‰æ›

var rawValue = msg.payload;
var celsius = (rawValue - 32) * 5 / 9;

msg.payload = {
    raw: rawValue,
    celsius: celsius.toFixed(2),
    timestamp: new Date().toISOString()
};

return msg;</div>
        
        <h3>ã‚±ãƒ¼ã‚¹2: ãƒ‡ãƒ¼ã‚¿ã®é›†ç´„</h3>
        <div class="js-code" data-copy="true">// è¤‡æ•°ã®ã‚»ãƒ³ã‚µãƒ¼å€¤ã‚’é›†ç´„

var data = flow.get('sensorData') || [];
data.push(msg.payload);

// æœ€æ–°10ä»¶ã®ã¿ä¿æŒ
if (data.length > 10) {
    data.shift();
}

flow.set('sensorData', data);

// å¹³å‡å€¤ã‚’è¨ˆç®—
var sum = data.reduce(function(a, b) { return a + b; }, 0);

msg.payload = {
    average: sum / data.length,
    count: data.length
};

return msg;</div>
        
        <h3>ã‚±ãƒ¼ã‚¹3: APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ•´å½¢</h3>
        <div class="js-code" data-copy="true">// APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º

try {
    var response = msg.payload;
    
    msg.payload = {
        id: response.data.id,
        name: response.data.name,
        status: response.data.active ? "æœ‰åŠ¹" : "ç„¡åŠ¹"
    };
    
    node.status({fill:"green", shape:"dot", text:"æˆåŠŸ"});
    return msg;
    
} catch (e) {
    node.error("ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼: " + e.message, msg);
    node.status({fill:"red", shape:"ring", text:"ã‚¨ãƒ©ãƒ¼"});
    return null;
}</div>
        
        <h3>ã‚±ãƒ¼ã‚¹4: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</h3>
        <div class="js-code" data-copy="true">// é‡è¤‡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é™¤å¤–

var lastValue = context.get('lastValue');

if (msg.payload === lastValue) {
    // åŒã˜å€¤ãªã‚‰é€ä¿¡ã—ãªã„
    return null;
}

// æ–°ã—ã„å€¤ã‚’ä¿å­˜
context.set('lastValue', msg.payload);

return msg;</div>
        
        <h2>ğŸ“— 8. è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹</h2>
        
        <ul>
            <li><a href="https://nodered.org/docs/user-guide/writing-functions" target="_blank">Node-REDå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: Functionãƒãƒ¼ãƒ‰</a></li>
            <li><a href="https://nodered.org/docs/user-guide/context" target="_blank">Node-REDå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</a></li>
            <li><a href="https://cookbook.nodered.org/" target="_blank">Node-RED Cookbook</a></li>
        </ul>
        
        <hr>
        
        <p style="text-align: center; color: #999; margin-top: 40px;">
            <small>ã“ã®ã‚¬ã‚¤ãƒ‰ãŒå½¹ã«ç«‹ã¡ã¾ã—ãŸã‚‰ã€å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç·´ç¿’ã—ã¦ã¿ã¦ãã ã•ã„!<br>
            Functionãƒãƒ¼ãƒ‰ã¯ã‚«ã‚¹ã‚¿ãƒ å‡¦ç†ã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</small><br>
            <small>å‚ç…§å…ƒï¼šNodeREDã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼å†…ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼</small>
        </p>
    </div>
    
    <script>
        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function showTab(tabId) {
            // å…¨ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
            document.querySelectorAll('.tab-content').forEach(function(tab) {
                tab.classList.remove('active');
            });
            // å…¨ã¦ã®ãƒœã‚¿ãƒ³ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤
            document.querySelectorAll('.tab-button').forEach(function(btn) {
                btn.classList.remove('active');
            });
            // æŒ‡å®šã‚¿ãƒ–ã‚’è¡¨ç¤º
            document.getElementById(tabId).classList.add('active');
            // å¯¾å¿œãƒœã‚¿ãƒ³ã‚’é¸æŠçŠ¶æ…‹ã«
            event.target.classList.add('active');
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
        document.addEventListener('DOMContentLoaded', function() {
            // .flow-jsonã¨.js-code[data-copy="true"]ã«ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
            var codeBlocks = document.querySelectorAll('.flow-json, .js-code[data-copy="true"]');
            
            codeBlocks.forEach(function(block) {
                // ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã‚’ä½œæˆ
                var button = document.createElement('button');
                button.className = 'copy-button';
                button.innerHTML = '<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>ã‚³ãƒ”ãƒ¼';
                
                // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
                button.addEventListener('click', function() {
                    // ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—ï¼ˆãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’é™¤å¤–ï¼‰
                    var code = block.textContent.replace(/ã‚³ãƒ”ãƒ¼(ã—ã¾ã—ãŸ!)?$/, '').trim();
                    
                    // æ”¹è¡Œã‚’é©åˆ‡ã«å‡¦ç†ï¼ˆNode-REDã«ãƒšãƒ¼ã‚¹ãƒˆæ™‚ã«è¦‹ã‚„ã™ãã™ã‚‹ï¼‰
                    if (block.classList.contains('js-code')) {
                        // JavaScriptã‚³ãƒ¼ãƒ‰ã®å ´åˆã€è¡Œã”ã¨ã«æ”¹è¡Œã‚’ç¶­æŒ
                        code = block.innerText.replace(/ã‚³ãƒ”ãƒ¼(ã—ã¾ã—ãŸ!)?$/, '').trim();
                    }
                    
                    // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
                    navigator.clipboard.writeText(code).then(function() {
                        // æˆåŠŸæ™‚ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
                        button.innerHTML = '<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ!';
                        button.classList.add('copied');
                        
                        // 2ç§’å¾Œã«å…ƒã«æˆ»ã™
                        setTimeout(function() {
                            button.innerHTML = '<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>ã‚³ãƒ”ãƒ¼';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(function(err) {
                        console.error('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
                        button.textContent = 'ã‚¨ãƒ©ãƒ¼';
                        setTimeout(function() {
                            button.innerHTML = '<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>ã‚³ãƒ”ãƒ¼';
                        }, 2000);
                    });
                });
                
                // ãƒœã‚¿ãƒ³ã‚’ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã«è¿½åŠ 
                block.style.position = 'relative';
                block.appendChild(button);
            });
        });
    </script>
</body>
</html>
