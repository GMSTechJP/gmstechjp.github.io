<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node-RED MQTT ãƒãƒ¼ãƒ‰å®Œå…¨ã‚¬ã‚¤ãƒ‰</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.8; max-width: 1000px; margin: 0 auto; padding: 20px; background-color: #f5f5f5; color: #333; }
        h1 { color: #b92d5d; border-bottom: 3px solid #b92d5d; padding-bottom: 10px; }
        h2 { color: #d33682; margin-top: 40px; border-left: 5px solid #d33682; padding-left: 15px; }
        h3 { color: #555; margin-top: 25px; }
        h4 { color: #666; margin-top: 20px; }
        .container { background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .node-example { background-color: #2d3133; padding: 20px; border-radius: 5px; margin: 20px 0; color: white; font-family: 'Courier New', monospace; display: flex; align-items: center; flex-wrap: wrap; gap: 5px; }
        .node { display: inline-block; padding: 8px 15px; border-radius: 4px; margin: 5px; font-weight: bold; font-size: 14px; }
        .node-inject { background-color: #3fadb5; color: white; }
        .node-debug { background-color: #87a48d; color: white; }
        .node-function { background-color: #e8a658; color: white; }
        .node-change { background-color: #e7a070; color: white; }
        .node-switch { background-color: #e2d96e; color: #333; }
        .node-mqtt-in { background-color: #c9b6d5; color: #333; }
        .node-mqtt-out { background-color: #c9b6d5; color: #333; }
        .node-catch { background-color: #e8967a; color: white; }
        .arrow { color: #999; font-size: 20px; margin: 0 10px; }
        .important { background-color: #fce4ec; border-left: 4px solid #b92d5d; padding: 15px; margin: 20px 0; border-radius: 0 5px 5px 0; }
        .tip { background-color: #e8f5e9; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 5px 5px 0; }
        .warning { background-color: #fff3e0; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 0 5px 5px 0; }
        .code-block { background-color: #2d3133; color: #f8f8f2; padding: 15px; border-radius: 5px; margin: 15px 0; overflow-x: auto; font-family: 'Courier New', Consolas, monospace; font-size: 14px; white-space: pre; }
        .flow-json { background-color: #1a1a2e; color: #a6e22e; padding: 15px; border-radius: 5px; font-family: 'Courier New', Consolas, monospace; font-size: 12px; overflow-x: auto; white-space: pre; position: relative; max-height: 400px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #b92d5d; color: white; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .exercise { background-color: #e3f2fd; padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid #2196f3; }
        .exercise h3 { color: #1976d2; margin-top: 0; }
        .difficulty { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 12px; font-weight: bold; margin-left: 10px; }
        .difficulty-easy { background-color: #c8e6c9; color: #2e7d32; }
        .difficulty-medium { background-color: #fff9c4; color: #f57f17; }
        .difficulty-hard { background-color: #ffcdd2; color: #c62828; }
        details { background-color: #f5f5f5; padding: 10px 15px; border-radius: 5px; margin: 10px 0; }
        details summary { cursor: pointer; font-weight: bold; color: #1976d2; }
        details[open] summary { margin-bottom: 10px; }
        .toc { background-color: #fafafa; border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin: 20px 0; }
        .toc h3 { margin-top: 0; color: #b92d5d; }
        .toc ul { list-style: none; padding-left: 0; }
        .toc li { padding: 5px 0; }
        .toc a { color: #1976d2; text-decoration: none; }
        .toc a:hover { text-decoration: underline; }
        .copy-btn { position: absolute; top: 5px; right: 5px; background-color: #666; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; }
        .copy-btn:hover { background-color: #888; }
        .node-compare { display: flex; gap: 20px; flex-wrap: wrap; margin: 20px 0; }
        .node-card { background: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; flex: 1; min-width: 280px; }
        .node-card h4 { margin-top: 0; color: #b92d5d; }
        .broker-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 20px; border-radius: 8px; margin: 10px 0; }
        .broker-box h4 { margin: 0 0 10px 0; }
        .broker-box code { background: rgba(255,255,255,0.2); padding: 2px 6px; border-radius: 3px; }
        .topic-tree { background: #f5f5f5; padding: 15px; border-radius: 8px; font-family: monospace; margin: 15px 0; }
        .topic-tree .level1 { margin-left: 0; }
        .topic-tree .level2 { margin-left: 20px; }
        .topic-tree .level3 { margin-left: 40px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“¡ Node-RED MQTT ãƒãƒ¼ãƒ‰å®Œå…¨ã‚¬ã‚¤ãƒ‰</h1>
        
        <div class="toc">
            <h3>ğŸ“š ç›®æ¬¡</h3>
            <ul>
                <li><a href="#section1">1. æ¦‚è¦</a></li>
                <li><a href="#section2">2. MQTTãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®š</a></li>
                <li><a href="#section3">3. MQTT In / Out ãƒãƒ¼ãƒ‰</a></li>
                <li><a href="#section4">4. ãƒˆãƒ”ãƒƒã‚¯ã¨ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰</a></li>
                <li><a href="#section5">5. å®Ÿç”¨çš„ãªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³</a></li>                <li><a href="#section6">6. æ¼”ç¿’å•é¡Œ</a></li>
                <li><a href="#section7">7. ã¾ã¨ã‚</a></li>
                <li><a href="#section8">8. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a></li>
                <li><a href="#section9">9. å®Ÿå‹™æ´»ç”¨ä¾‹</a></li>
            </ul>
        </div>
        
        <h2 id="section1">ğŸ“– 1. æ¦‚è¦</h2>
        
        <p>MQTTï¼ˆMessage Queuing Telemetry Transportï¼‰ã¯ã€<strong>IoTå‘ã‘ã®è»½é‡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ãƒ—ãƒ­ãƒˆã‚³ãƒ«</strong>ã§ã™ã€‚ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã®åé›†ã‚„æ©Ÿå™¨åˆ¶å¾¡ãªã©ã€å¤šæ•°ã®ãƒ‡ãƒã‚¤ã‚¹é–“é€šä¿¡ã«æœ€é©åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
        
        <h3>MQTTã®ç‰¹å¾´</h3>
        <ul>
            <li><strong>è»½é‡</strong>ï¼šãƒ˜ãƒƒãƒ€ãƒ¼ãŒå°ã•ãã€å¸¯åŸŸå¹…ã‚’ç¯€ç´„</li>
            <li><strong>Pub/Sub ãƒ¢ãƒ‡ãƒ«</strong>ï¼šé€ä¿¡è€…ã¨å—ä¿¡è€…ãŒç›´æ¥æ¥ç¶šã—ãªã„</li>
            <li><strong>QoSï¼ˆQuality of Serviceï¼‰</strong>ï¼šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é…ä¿¡ã®ä¿¡é ¼æ€§ã‚’é¸æŠå¯èƒ½</li>
            <li><strong>Retain</strong>ï¼šæœ€å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿æŒã—ã€æ–°è¦è³¼èª­è€…ã«é…ä¿¡</li>
        </ul>
        
        <p>ğŸ“¬ <strong>æ²ç¤ºæ¿ã«ä¾‹ãˆã‚‹ã¨</strong>ï¼šMQTTã¯ã€Œãƒ†ãƒ¼ãƒåˆ¥æ²ç¤ºæ¿ã€ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚</p>
        <ul>
            <li><strong>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼</strong>ï¼šæ²ç¤ºæ¿ã®ç®¡ç†äººï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä»²ä»‹ï¼‰</li>
            <li><strong>ãƒˆãƒ”ãƒƒã‚¯</strong>ï¼šæ²ç¤ºæ¿ã®ã‚«ãƒ†ã‚´ãƒªï¼ˆä¾‹ï¼šã€Œã‚»ãƒ³ã‚µãƒ¼/æ¸©åº¦ã€ã€Œã‚»ãƒ³ã‚µãƒ¼/æ¹¿åº¦ã€ï¼‰</li>
            <li><strong>Publishï¼ˆç™ºè¡Œï¼‰</strong>ï¼šæ²ç¤ºæ¿ã«æŠ•ç¨¿</li>
            <li><strong>Subscribeï¼ˆè³¼èª­ï¼‰</strong>ï¼šç‰¹å®šã‚«ãƒ†ã‚´ãƒªã®æŠ•ç¨¿ã‚’å—ã‘å–ã‚‹</li>
        </ul>
        
        <div class="node-compare">
            <div class="node-card">
                <h4>ğŸ“¥ MQTT Inï¼ˆSubscribeï¼‰</h4>
                <div class="node-example" style="justify-content: center;">
                    <span class="node node-mqtt-in">MQTT In</span>
                </div>
                <p><strong>å½¹å‰²:</strong> ãƒˆãƒ”ãƒƒã‚¯ã‚’è³¼èª­ã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡</p>
            </div>
            
            <div class="node-card">
                <h4>ğŸ“¤ MQTT Outï¼ˆPublishï¼‰</h4>
                <div class="node-example" style="justify-content: center;">
                    <span class="node node-mqtt-out">MQTT Out</span>
                </div>
                <p><strong>å½¹å‰²:</strong> ãƒˆãƒ”ãƒƒã‚¯ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç™ºè¡Œ</p>
            </div>
        </div>
        
        <h2 id="section2">âš™ï¸ 2. MQTTãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®š</h2>
        
        <p>MQTTãƒãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ã¾ãš<strong>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®šãƒãƒ¼ãƒ‰</strong>ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
        
        <h3>å…¬é–‹MQTTãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ï¼ˆå­¦ç¿’ãƒ»ãƒ†ã‚¹ãƒˆç”¨ï¼‰</h3>
        
        <div class="broker-box">
            <h4>ğŸ¦Ÿ test.mosquitto.org</h4>
            <p>Eclipse Mosquitto ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæä¾›ã®å…¬é–‹ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼</p>
            <p><code>Server: test.mosquitto.org</code> / <code>Port: 1883</code>ï¼ˆéæš—å·åŒ–ï¼‰</p>
        </div>
        
        <div class="broker-box">
            <h4>ğŸ broker.hivemq.com</h4>
            <p>HiveMQæä¾›ã®å…¬é–‹ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼</p>
            <p><code>Server: broker.hivemq.com</code> / <code>Port: 1883</code></p>
        </div>
        
        <div class="broker-box">
            <h4>ğŸ“¦ broker.emqx.io</h4>
            <p>EMQ Xæä¾›ã®å…¬é–‹ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼</p>
            <p><code>Server: broker.emqx.io</code> / <code>Port: 1883</code></p>
        </div>
        
        <div class="warning">
            <p><strong>âš ï¸ å…¬é–‹ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã®æ³¨æ„äº‹é …:</strong></p>
            <ul>
                <li>èª°ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªã®ã§ã€<strong>æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã¯é€ã‚‰ãªã„</strong></li>
                <li>ãƒˆãƒ”ãƒƒã‚¯åã¯<strong>ãƒ¦ãƒ‹ãƒ¼ã‚¯ã«</strong>ï¼ˆä¾‹: <code>yourname/sensor/temp</code>ï¼‰</li>
                <li>ã‚µãƒ¼ãƒ“ã‚¹ã®ç¨¼åƒçŠ¶æ³ã«ã‚ˆã‚Šæ¥ç¶šã§ããªã„å ´åˆãŒã‚ã‚‹</li>
            </ul>
        </div>
        
        <h3>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h3>
        <table>
            <tr><th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th><th>èª¬æ˜</th><th>ä¾‹</th></tr>
            <tr><td><strong>Server</strong></td><td>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã®ãƒ›ã‚¹ãƒˆå/IP</td><td>test.mosquitto.org</td></tr>
            <tr><td><strong>Port</strong></td><td>æ¥ç¶šãƒãƒ¼ãƒˆ</td><td>1883ï¼ˆéæš—å·åŒ–ï¼‰, 8883ï¼ˆTLSï¼‰</td></tr>
            <tr><td><strong>Client ID</strong></td><td>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè­˜åˆ¥å­ï¼ˆç©ºæ¬„ã§è‡ªå‹•ç”Ÿæˆï¼‰</td><td>nodered-client-001</td></tr>
            <tr><td><strong>Keep Alive</strong></td><td>æ¥ç¶šç¶­æŒé–“éš”ï¼ˆç§’ï¼‰</td><td>60</td></tr>
            <tr><td><strong>Clean Session</strong></td><td>æ¥ç¶šæ™‚ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢</td><td>true</td></tr>
        </table>
        
        <h3>èªè¨¼è¨­å®šï¼ˆSecurity ã‚¿ãƒ–ï¼‰</h3>
        <table>
            <tr><th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th><th>èª¬æ˜</th></tr>
            <tr><td><strong>Username</strong></td><td>èªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼å</td></tr>
            <tr><td><strong>Password</strong></td><td>èªè¨¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</td></tr>
            <tr><td><strong>TLS</strong></td><td>æš—å·åŒ–æ¥ç¶šã®è¨­å®š</td></tr>
        </table>
        
        <h2 id="section3">âš™ï¸ 3. MQTT In / Out ãƒãƒ¼ãƒ‰</h2>
        
        <h3>MQTT In ãƒãƒ¼ãƒ‰ï¼ˆè³¼èª­ï¼‰</h3>
        <table>
            <tr><th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th><th>èª¬æ˜</th><th>ä¾‹</th></tr>
            <tr><td><strong>Server</strong></td><td>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®š</td><td>ï¼ˆè¨­å®šãƒãƒ¼ãƒ‰é¸æŠï¼‰</td></tr>
            <tr><td><strong>Topic</strong></td><td>è³¼èª­ã™ã‚‹ãƒˆãƒ”ãƒƒã‚¯</td><td>sensors/+/temperature</td></tr>
            <tr><td><strong>QoS</strong></td><td>ã‚µãƒ¼ãƒ“ã‚¹å“è³ª</td><td>0, 1, 2</td></tr>
            <tr><td><strong>Output</strong></td><td>å‡ºåŠ›å½¢å¼</td><td>auto, string, buffer, JSON</td></tr>
        </table>
        
        <p><strong>å—ä¿¡æ™‚ã® msg ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£:</strong></p>
        <table>
            <tr><th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th><th>èª¬æ˜</th></tr>
            <tr><td><strong>msg.payload</strong></td><td>å—ä¿¡ãƒ‡ãƒ¼ã‚¿</td></tr>
            <tr><td><strong>msg.topic</strong></td><td>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒˆãƒ”ãƒƒã‚¯</td></tr>
            <tr><td><strong>msg.qos</strong></td><td>QoSãƒ¬ãƒ™ãƒ«</td></tr>
            <tr><td><strong>msg.retain</strong></td><td>Retainãƒ•ãƒ©ã‚°</td></tr>
        </table>
        
        <h3>MQTT Out ãƒãƒ¼ãƒ‰ï¼ˆç™ºè¡Œï¼‰</h3>
        <table>
            <tr><th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th><th>èª¬æ˜</th><th>ä¾‹</th></tr>
            <tr><td><strong>Server</strong></td><td>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®š</td><td>ï¼ˆè¨­å®šãƒãƒ¼ãƒ‰é¸æŠï¼‰</td></tr>
            <tr><td><strong>Topic</strong></td><td>ç™ºè¡Œå…ˆãƒˆãƒ”ãƒƒã‚¯ï¼ˆç©ºæ¬„ã§msg.topicä½¿ç”¨ï¼‰</td><td>devices/lamp/control</td></tr>
            <tr><td><strong>QoS</strong></td><td>ã‚µãƒ¼ãƒ“ã‚¹å“è³ª</td><td>0, 1, 2</td></tr>
            <tr><td><strong>Retain</strong></td><td>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿æŒ</td><td>true/false</td></tr>
        </table>
        
        <h3>QoSï¼ˆQuality of Serviceï¼‰ãƒ¬ãƒ™ãƒ«</h3>
        <table>
            <tr><th>QoS</th><th>èª¬æ˜</th><th>ç”¨é€”</th></tr>
            <tr><td><strong>0</strong></td><td>At most onceï¼ˆæœ€å¤§1å›ï¼‰</td><td>ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ãªã©ã€å¤šå°‘ã®ãƒ­ã‚¹ãŒè¨±å®¹ã§ãã‚‹å ´åˆ</td></tr>
            <tr><td><strong>1</strong></td><td>At least onceï¼ˆæœ€ä½1å›ï¼‰</td><td>é‡è¦ãƒ‡ãƒ¼ã‚¿ï¼ˆé‡è¤‡ã®å¯èƒ½æ€§ã‚ã‚Šï¼‰</td></tr>
            <tr><td><strong>2</strong></td><td>Exactly onceï¼ˆæ­£ç¢ºã«1å›ï¼‰</td><td>èª²é‡‘ãªã©ã€å³å¯†ãªé…ä¿¡ãŒå¿…è¦ãªå ´åˆ</td></tr>
        </table>
        
        <h2 id="section4">ğŸ·ï¸ 4. ãƒˆãƒ”ãƒƒã‚¯ã¨ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰</h2>
        
        <h3>ãƒˆãƒ”ãƒƒã‚¯ã®éšå±¤æ§‹é€ </h3>
        <p>MQTTã®ãƒˆãƒ”ãƒƒã‚¯ã¯ <code>/</code> ã§åŒºåˆ‡ã£ãŸéšå±¤æ§‹é€ ã§è¨­è¨ˆã—ã¾ã™ï¼š</p>
        
        <div class="topic-tree">
            <div class="level1">ğŸ“ home</div>
            <div class="level2">ğŸ“ livingroom</div>
            <div class="level3">ğŸ“„ temperature</div>
            <div class="level3">ğŸ“„ humidity</div>
            <div class="level3">ğŸ“„ light</div>
            <div class="level2">ğŸ“ bedroom</div>
            <div class="level3">ğŸ“„ temperature</div>
            <div class="level3">ğŸ“„ humidity</div>
        </div>
        
        <div class="code-block">// ãƒˆãƒ”ãƒƒã‚¯ä¾‹
home/livingroom/temperature  â†’ 25.5
home/livingroom/humidity     â†’ 60
home/bedroom/temperature     â†’ 22.0</div>
        
        <h3>ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰</h3>
        <table>
            <tr><th>ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰</th><th>èª¬æ˜</th><th>ä¾‹</th></tr>
            <tr>
                <td><strong>+</strong>ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒ¬ãƒ™ãƒ«ï¼‰</td>
                <td>1éšå±¤ã®ã¿ã«ãƒãƒƒãƒ</td>
                <td><code>home/+/temperature</code><br>â†’ home/livingroom/temperature âœ“<br>â†’ home/bedroom/temperature âœ“</td>
            </tr>
            <tr>
                <td><strong>#</strong>ï¼ˆãƒãƒ«ãƒãƒ¬ãƒ™ãƒ«ï¼‰</td>
                <td>ä»¥é™ã®å…¨éšå±¤ã«ãƒãƒƒãƒï¼ˆæœ«å°¾ã®ã¿ï¼‰</td>
                <td><code>home/#</code><br>â†’ home/livingroom/temperature âœ“<br>â†’ home/bedroom/humidity âœ“</td>
            </tr>
        </table>
        
        <div class="tip">
            <p><strong>ğŸ’¡ ãƒˆãƒ”ãƒƒã‚¯è¨­è¨ˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹:</strong></p>
            <ul>
                <li>æ„å‘³ã®ã‚ã‚‹éšå±¤æ§‹é€ ã«ã™ã‚‹ï¼ˆå ´æ‰€/ãƒ‡ãƒã‚¤ã‚¹/ã‚»ãƒ³ã‚µãƒ¼ï¼‰</li>
                <li>å°æ–‡å­—ã¨ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã‚’ä½¿ç”¨</li>
                <li>å…ˆé ­ã« <code>/</code> ã‚’ä»˜ã‘ãªã„ï¼ˆ<code>home/temp</code> ãŒæ¨å¥¨ã€<code>/home/temp</code> ã¯éæ¨å¥¨ï¼‰</li>
                <li>ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ¥é ­è¾ã‚’ä½¿ç”¨ï¼ˆå…¬é–‹ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã§ã¯ç‰¹ã«é‡è¦ï¼‰</li>
            </ul>
        </div>
        
        <h2 id="section5">ğŸ”§ 5. å®Ÿç”¨çš„ãªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³</h2>
        <div class="important">
            <p><strong>ğŸ“¥ ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–¹æ³•:</strong></p>
            <ol>
                <li>ä¸‹ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼JSONã‚’ã‚³ãƒ”ãƒ¼</li>
                <li>Node-REDã‚¨ãƒ‡ã‚£ã‚¿ã§ <strong>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ â†’ èª­ã¿è¾¼ã¿</strong> ã‚’é¸æŠ</li>
                <li>JSONã‚’ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ã€Œèª­ã¿è¾¼ã¿ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
            </ol>
            <p>ã“ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã«ã¯ã€ä»¥ä¸‹ã§èª¬æ˜ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿä¾‹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚</p>
        </div>

        
        <div class="important">
            <p><strong>âš ï¸ ä½¿ç”¨å‰ã®æº–å‚™:</strong></p>
            <ol>
                <li>ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</li>
                <li>MQTT In/Out ãƒãƒ¼ãƒ‰ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯</li>
                <li>Server ã®é‰›ç­†ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦<strong>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®šã‚’ç¢ºèª</strong></li>
                <li>å¿…è¦ã«å¿œã˜ã¦ Server ã‚’ <code>test.mosquitto.org</code> ã«å¤‰æ›´</li>
                <li>ãƒ‡ãƒ—ãƒ­ã‚¤</li>
            </ol>
            <p>â€» ãƒˆãƒ”ãƒƒã‚¯åã® <code>nodered-guide</code> éƒ¨åˆ†ã‚’è‡ªåˆ†å°‚ç”¨ã®åå‰ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™</p>
        </div>
        
        <details>
            <summary>ğŸ“¥ ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼JSONï¼ˆã‚¯ãƒªãƒƒã‚¯ã§å±•é–‹ï¼‰</summary>
            <div class="flow-json">[
    {
        "id": "mqtt_sample_tab",
        "type": "tab",
        "label": "MQTT ã‚µãƒ³ãƒ—ãƒ«",
        "disabled": false,
        "info": ""
    },
    {
        "id": "mqtt_broker_public",
        "type": "mqtt-broker",
        "name": "Public Broker",
        "broker": "test.mosquitto.org",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true
    },
    {
        "id": "mqtt_comment1",
        "type": "comment",
        "z": "mqtt_sample_tab",
        "name": "â”â”â” åŸºæœ¬: Publishï¼ˆç™ºè¡Œï¼‰ â”â”â”",
        "info": "",
        "x": 180,
        "y": 40,
        "wires": []
    },
    {
        "id": "mqtt_inject_temp",
        "type": "inject",
        "z": "mqtt_sample_tab",
        "name": "æ¸©åº¦ãƒ‡ãƒ¼ã‚¿é€ä¿¡",
        "props": [{"p": "payload"}, {"p": "topic", "vt": "str"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "nodered-guide/sensors/temperature",
        "payload": "25.5",
        "payloadType": "num",
        "x": 180,
        "y": 100,
        "wires": [["mqtt_out_sensor"]]
    },
    {
        "id": "mqtt_inject_humidity",
        "type": "inject",
        "z": "mqtt_sample_tab",
        "name": "æ¹¿åº¦ãƒ‡ãƒ¼ã‚¿é€ä¿¡",
        "props": [{"p": "payload"}, {"p": "topic", "vt": "str"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "nodered-guide/sensors/humidity",
        "payload": "60",
        "payloadType": "num",
        "x": 180,
        "y": 140,
        "wires": [["mqtt_out_sensor"]]
    },
    {
        "id": "mqtt_out_sensor",
        "type": "mqtt out",
        "z": "mqtt_sample_tab",
        "name": "Publish Sensor",
        "topic": "",
        "qos": "1",
        "retain": "false",
        "broker": "mqtt_broker_public",
        "x": 420,
        "y": 120,
        "wires": []
    },
    {
        "id": "mqtt_comment2",
        "type": "comment",
        "z": "mqtt_sample_tab",
        "name": "â”â”â” åŸºæœ¬: Subscribeï¼ˆè³¼èª­ï¼‰ â”â”â”",
        "info": "",
        "x": 190,
        "y": 220,
        "wires": []
    },
    {
        "id": "mqtt_in_sensors",
        "type": "mqtt in",
        "z": "mqtt_sample_tab",
        "name": "Subscribe sensors/#",
        "topic": "nodered-guide/sensors/#",
        "qos": "1",
        "datatype": "auto",
        "broker": "mqtt_broker_public",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 280,
        "wires": [["mqtt_debug_sensors", "mqtt_func_format"]]
    },
    {
        "id": "mqtt_debug_sensors",
        "type": "debug",
        "z": "mqtt_sample_tab",
        "name": "å—ä¿¡ãƒ‡ãƒ¼ã‚¿",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "true",
        "targetType": "full",
        "statusVal": "topic",
        "statusType": "msg",
        "x": 430,
        "y": 280,
        "wires": []
    },
    {
        "id": "mqtt_func_format",
        "type": "function",
        "z": "mqtt_sample_tab",
        "name": "ãƒ‡ãƒ¼ã‚¿æ•´å½¢",
        "func": "var parts = msg.topic.split('/');\nvar sensorType = parts[parts.length - 1];\n\nmsg.formatted = {\n    sensor: sensorType,\n    value: msg.payload,\n    topic: msg.topic,\n    timestamp: new Date().toISOString()\n};\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 320,
        "wires": [["mqtt_debug_formatted"]]
    },
    {
        "id": "mqtt_debug_formatted",
        "type": "debug",
        "z": "mqtt_sample_tab",
        "name": "æ•´å½¢ãƒ‡ãƒ¼ã‚¿",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "formatted",
        "targetType": "msg",
        "statusVal": "formatted.sensor",
        "statusType": "msg",
        "x": 610,
        "y": 320,
        "wires": []
    },
    {
        "id": "mqtt_comment3",
        "type": "comment",
        "z": "mqtt_sample_tab",
        "name": "â”â”â” JSON ãƒ‡ãƒ¼ã‚¿ã®é€å—ä¿¡ â”â”â”",
        "info": "",
        "x": 190,
        "y": 400,
        "wires": []
    },
    {
        "id": "mqtt_inject_json",
        "type": "inject",
        "z": "mqtt_sample_tab",
        "name": "JSONãƒ‡ãƒ¼ã‚¿é€ä¿¡",
        "props": [{"p": "payload"}, {"p": "topic", "vt": "str"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "nodered-guide/device/status",
        "payload": "{\"device\":\"sensor-001\",\"temperature\":25.5,\"humidity\":60,\"battery\":85}",
        "payloadType": "json",
        "x": 180,
        "y": 460,
        "wires": [["mqtt_func_stringify"]]
    },
    {
        "id": "mqtt_func_stringify",
        "type": "function",
        "z": "mqtt_sample_tab",
        "name": "JSONæ–‡å­—åˆ—åŒ–",
        "func": "msg.payload = JSON.stringify(msg.payload);\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 460,
        "wires": [["mqtt_out_json"]]
    },
    {
        "id": "mqtt_out_json",
        "type": "mqtt out",
        "z": "mqtt_sample_tab",
        "name": "Publish JSON",
        "topic": "",
        "qos": "1",
        "retain": "false",
        "broker": "mqtt_broker_public",
        "x": 590,
        "y": 460,
        "wires": []
    },
    {
        "id": "mqtt_in_json",
        "type": "mqtt in",
        "z": "mqtt_sample_tab",
        "name": "Subscribe device/#",
        "topic": "nodered-guide/device/#",
        "qos": "1",
        "datatype": "json",
        "broker": "mqtt_broker_public",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 520,
        "wires": [["mqtt_debug_json"]]
    },
    {
        "id": "mqtt_debug_json",
        "type": "debug",
        "z": "mqtt_sample_tab",
        "name": "JSONå—ä¿¡",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "payload.device",
        "statusType": "msg",
        "x": 420,
        "y": 520,
        "wires": []
    },
    {
        "id": "mqtt_comment4",
        "type": "comment",
        "z": "mqtt_sample_tab",
        "name": "â”â”â” ãƒ‡ãƒã‚¤ã‚¹åˆ¶å¾¡ï¼ˆã‚³ãƒãƒ³ãƒ‰é€å—ä¿¡ï¼‰ â”â”â”",
        "info": "",
        "x": 210,
        "y": 600,
        "wires": []
    },
    {
        "id": "mqtt_inject_on",
        "type": "inject",
        "z": "mqtt_sample_tab",
        "name": "LED ON",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "ON",
        "payloadType": "str",
        "x": 150,
        "y": 660,
        "wires": [["mqtt_out_control"]]
    },
    {
        "id": "mqtt_inject_off",
        "type": "inject",
        "z": "mqtt_sample_tab",
        "name": "LED OFF",
        "props": [{"p": "payload"}],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "OFF",
        "payloadType": "str",
        "x": 150,
        "y": 700,
        "wires": [["mqtt_out_control"]]
    },
    {
        "id": "mqtt_out_control",
        "type": "mqtt out",
        "z": "mqtt_sample_tab",
        "name": "Publish Control",
        "topic": "nodered-guide/control/led",
        "qos": "1",
        "retain": "true",
        "broker": "mqtt_broker_public",
        "x": 360,
        "y": 680,
        "wires": []
    },
    {
        "id": "mqtt_in_control",
        "type": "mqtt in",
        "z": "mqtt_sample_tab",
        "name": "Subscribe control/#",
        "topic": "nodered-guide/control/#",
        "qos": "1",
        "datatype": "utf8",
        "broker": "mqtt_broker_public",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 760,
        "wires": [["mqtt_switch_control"]]
    },
    {
        "id": "mqtt_switch_control",
        "type": "switch",
        "z": "mqtt_sample_tab",
        "name": "ON/OFFåˆ¤å®š",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {"t": "eq", "v": "ON", "vt": "str"},
            {"t": "eq", "v": "OFF", "vt": "str"}
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 410,
        "y": 760,
        "wires": [["mqtt_debug_on"], ["mqtt_debug_off"]]
    },
    {
        "id": "mqtt_debug_on",
        "type": "debug",
        "z": "mqtt_sample_tab",
        "name": "LED ON!",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "\"ğŸ’¡ ON\"",
        "statusType": "str",
        "x": 580,
        "y": 740,
        "wires": []
    },
    {
        "id": "mqtt_debug_off",
        "type": "debug",
        "z": "mqtt_sample_tab",
        "name": "LED OFF!",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": true,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "\"âš« OFF\"",
        "statusType": "str",
        "x": 580,
        "y": 780,
        "wires": []
    }
]</div>
        </details>
        
        
        <h3>ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³</h3>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³1: åŸºæœ¬ Publishï¼ˆç™ºè¡Œï¼‰</h3>
        <p>ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã®ã€ŒåŸºæœ¬: Publishï¼ˆç™ºè¡Œï¼‰ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
        <div class="node-example">
            <span class="node node-inject">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</span>
            <span class="arrow">â†’</span>
            <span class="node node-mqtt-out">MQTT Out</span>
        </div>
        <p><strong>ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
        <ul>
            <li>msg.payload ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’è¨­å®š</li>
            <li>ãƒˆãƒ”ãƒƒã‚¯ã¯ãƒãƒ¼ãƒ‰è¨­å®šã¾ãŸã¯ msg.topic ã§æŒ‡å®š</li>
            <li>QoS ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é…ä¿¡ã®ä¿¡é ¼æ€§ã‚’é¸æŠ</li>
        </ul>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³2: åŸºæœ¬ Subscribeï¼ˆè³¼èª­ï¼‰</h3>
        <p>ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã®ã€ŒåŸºæœ¬: Subscribeï¼ˆè³¼èª­ï¼‰ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
        <div class="node-example">
            <span class="node node-mqtt-in">MQTT In</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º</span>
        </div>
        <p><strong>ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
        <ul>
            <li>è³¼èª­ãƒˆãƒ”ãƒƒã‚¯ã¯ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ï¼ˆ#, +ï¼‰ä½¿ç”¨å¯èƒ½</li>
            <li>msg.topic ã«å—ä¿¡ã—ãŸãƒˆãƒ”ãƒƒã‚¯åãŒæ ¼ç´ã•ã‚Œã‚‹</li>
            <li>Outputè¨­å®šã§è‡ªå‹•å‹æ¤œå‡ºã¾ãŸã¯String/BufferæŒ‡å®š</li>
        </ul>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³3: JSONãƒ‡ãƒ¼ã‚¿ã®é€å—ä¿¡</h3>
        <p>ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã®ã€ŒJSON ãƒ‡ãƒ¼ã‚¿ã®é€å—ä¿¡ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
        <div class="node-example">
            <span class="node node-inject">JSONç”Ÿæˆ</span>
            <span class="arrow">â†’</span>
            <span class="node node-mqtt-out">é€ä¿¡</span>
            <span style="margin: 0 20px;">ï½œ</span>
            <span class="node node-mqtt-in">å—ä¿¡</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">JSONç¢ºèª</span>
        </div>
        <p><strong>ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
        <ul>
            <li>é€ä¿¡æ™‚: msg.payload ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­å®šã™ã‚‹ã¨è‡ªå‹•ã§JSONæ–‡å­—åˆ—åŒ–</li>
            <li>å—ä¿¡æ™‚: Output ã‚’ auto-detect ã«ã™ã‚‹ã¨è‡ªå‹•ã§ãƒ‘ãƒ¼ã‚¹</li>
            <li>ã‚»ãƒ³ã‚µãƒ¼å€¤ãªã©æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®é€å—ä¿¡ã«æœ€é©</li>
        </ul>
        
        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³4: ãƒ‡ãƒã‚¤ã‚¹åˆ¶å¾¡ï¼ˆã‚³ãƒãƒ³ãƒ‰é€å—ä¿¡ï¼‰</h3>
        <p>ã‚µãƒ³ãƒ—ãƒ«ãƒ•ãƒ­ãƒ¼ã®ã€Œãƒ‡ãƒã‚¤ã‚¹åˆ¶å¾¡ï¼ˆã‚³ãƒãƒ³ãƒ‰é€å—ä¿¡ï¼‰ã€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
        <div class="node-example">
            <span class="node node-mqtt-in">ã‚³ãƒãƒ³ãƒ‰å—ä¿¡</span>
            <span class="arrow">â†’</span>
            <span class="node node-switch">ON/OFFåˆ†å²</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">ãƒ‡ãƒã‚¤ã‚¹åˆ¶å¾¡</span>
        </div>
        <p><strong>ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
        <ul>
            <li>ãƒ‡ãƒã‚¤ã‚¹ã”ã¨ã«ãƒˆãƒ”ãƒƒã‚¯ã‚’åˆ†ã‘ã‚‹ï¼ˆä¾‹: home/light/livingï¼‰</li>
            <li>Switchãƒãƒ¼ãƒ‰ã§ã‚³ãƒãƒ³ãƒ‰å†…å®¹ï¼ˆON/OFFç­‰ï¼‰ã‚’åˆ†å²</li>
            <li>åˆ¶å¾¡çµæœã‚’statusãƒˆãƒ”ãƒƒã‚¯ã«ç™ºè¡Œã™ã‚‹ã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å¯èƒ½</li>
        </ul>
        
        <h2 id="section6">ğŸ“ 6. æ¼”ç¿’å•é¡Œ</h2>
        
        <div class="exercise">
            <h3>æ¼”ç¿’1: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç™ºè¡Œ <span class="difficulty difficulty-easy">åˆç´š</span></h3>
            <p><strong>ğŸ“‹ èª²é¡Œ:</strong> ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€MQTTãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã«ã€ŒHello MQTT!ã€ã‚’ç™ºè¡Œã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li>ãƒˆãƒ”ãƒƒã‚¯: <code>ã‚ãªãŸã®åå‰/test/hello</code></li>
                <li>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: <code>Hello MQTT!</code></li>
                <li>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼: test.mosquitto.org</li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>Inject ãƒãƒ¼ãƒ‰:</strong> msg.payload ã«ã€ŒHello MQTT!ã€ã‚’è¨­å®š</p>
                <p><strong>MQTT Out ãƒãƒ¼ãƒ‰:</strong></p>
                <ul>
                    <li>Server: test.mosquitto.orgï¼ˆæ–°è¦ä½œæˆï¼‰</li>
                    <li>Topic: ã‚ãªãŸã®åå‰/test/hello</li>
                    <li>QoS: 1</li>
                </ul>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">[
    {"id": "ex1_tab", "type": "tab", "label": "æ¼”ç¿’1"},
    {"id": "ex1_broker", "type": "mqtt-broker", "name": "Public Broker", "broker": "test.mosquitto.org", "port": "1883", "clientid": "", "autoConnect": true, "usetls": false, "protocolVersion": "4", "keepalive": "60", "cleansession": true},
    {"id": "ex1_inject", "type": "inject", "z": "ex1_tab", "name": "Helloé€ä¿¡", "props": [{"p": "payload"}], "repeat": "", "crontab": "", "once": false, "onceDelay": 0.1, "topic": "", "payload": "Hello MQTT!", "payloadType": "str", "x": 160, "y": 100, "wires": [["ex1_mqtt_out"]]},
    {"id": "ex1_mqtt_out", "type": "mqtt out", "z": "ex1_tab", "name": "Publish", "topic": "yourname/test/hello", "qos": "1", "retain": "false", "broker": "ex1_broker", "x": 350, "y": 100, "wires": []}
]</div>
            </details>
        </div>
        
        <div class="exercise">
            <h3>æ¼”ç¿’2: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è³¼èª­ <span class="difficulty difficulty-easy">åˆç´š</span></h3>
            <p><strong>ğŸ“‹ èª²é¡Œ:</strong> æ¼”ç¿’1ã§ç™ºè¡Œã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è³¼èª­ã—ã¦ã€Debugãƒãƒ¼ãƒ‰ã«è¡¨ç¤ºã—ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li>ãƒˆãƒ”ãƒƒã‚¯: <code>ã‚ãªãŸã®åå‰/test/hello</code></li>
                <li>å—ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ‡ãƒãƒƒã‚°ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¡¨ç¤º</li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>MQTT In ãƒãƒ¼ãƒ‰:</strong></p>
                <ul>
                    <li>Server: æ¼”ç¿’1ã¨åŒã˜ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®š</li>
                    <li>Topic: æ¼”ç¿’1ã¨åŒã˜ãƒˆãƒ”ãƒƒã‚¯</li>
                    <li>QoS: 1</li>
                    <li>Output: auto-detect</li>
                </ul>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">[
    {"id": "ex2_tab", "type": "tab", "label": "æ¼”ç¿’2"},
    {"id": "ex2_broker", "type": "mqtt-broker", "name": "Public Broker", "broker": "test.mosquitto.org", "port": "1883", "clientid": "", "autoConnect": true, "usetls": false, "protocolVersion": "4", "keepalive": "60", "cleansession": true},
    {"id": "ex2_mqtt_in", "type": "mqtt in", "z": "ex2_tab", "name": "Subscribe", "topic": "yourname/test/hello", "qos": "1", "datatype": "auto", "broker": "ex2_broker", "nl": false, "rap": true, "rh": 0, "inputs": 0, "x": 160, "y": 100, "wires": [["ex2_debug"]]},
    {"id": "ex2_debug", "type": "debug", "z": "ex2_tab", "name": "å—ä¿¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸", "active": true, "tosidebar": true, "console": false, "tostatus": true, "complete": "payload", "targetType": "msg", "statusVal": "payload", "statusType": "msg", "x": 380, "y": 100, "wires": []}
]</div>
            </details>
        </div>
        
        <div class="exercise">
            <h3>æ¼”ç¿’3: ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã«ã‚ˆã‚‹è¤‡æ•°ãƒˆãƒ”ãƒƒã‚¯è³¼èª­ <span class="difficulty difficulty-medium">ä¸­ç´š</span></h3>
            <p><strong>ğŸ“‹ èª²é¡Œ:</strong> ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦è¤‡æ•°ã®ã‚»ãƒ³ã‚µãƒ¼ãƒˆãƒ”ãƒƒã‚¯ã‚’ä¸€æ‹¬è³¼èª­ã—ã€ãƒˆãƒ”ãƒƒã‚¯ã”ã¨ã«ç•°ãªã‚‹å‡¦ç†ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li>ç™ºè¡Œãƒˆãƒ”ãƒƒã‚¯: <code>yourname/sensors/temperature</code>, <code>yourname/sensors/humidity</code></li>
                <li>è³¼èª­ãƒˆãƒ”ãƒƒã‚¯: <code>yourname/sensors/+</code>ï¼ˆãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ä½¿ç”¨ï¼‰</li>
                <li>ãƒˆãƒ”ãƒƒã‚¯ã‹ã‚‰ã€Œtemperatureã€ã‹ã€Œhumidityã€ã‹ã‚’åˆ¤å®š</li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>Switch ãƒãƒ¼ãƒ‰:</strong></p>
                <ul>
                    <li>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: msg.topic</li>
                    <li>æ¡ä»¶1: contains "temperature"</li>
                    <li>æ¡ä»¶2: contains "humidity"</li>
                </ul>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">[
    {"id": "ex3_tab", "type": "tab", "label": "æ¼”ç¿’3"},
    {"id": "ex3_broker", "type": "mqtt-broker", "name": "Public Broker", "broker": "test.mosquitto.org", "port": "1883", "clientid": "", "autoConnect": true, "usetls": false, "protocolVersion": "4", "keepalive": "60", "cleansession": true},
    {"id": "ex3_inject_temp", "type": "inject", "z": "ex3_tab", "name": "æ¸©åº¦é€ä¿¡", "props": [{"p": "payload"}, {"p": "topic", "vt": "str"}], "repeat": "", "crontab": "", "once": false, "onceDelay": 0.1, "topic": "yourname/sensors/temperature", "payload": "25.5", "payloadType": "num", "x": 160, "y": 80, "wires": [["ex3_mqtt_out"]]},
    {"id": "ex3_inject_humidity", "type": "inject", "z": "ex3_tab", "name": "æ¹¿åº¦é€ä¿¡", "props": [{"p": "payload"}, {"p": "topic", "vt": "str"}], "repeat": "", "crontab": "", "once": false, "onceDelay": 0.1, "topic": "yourname/sensors/humidity", "payload": "60", "payloadType": "num", "x": 160, "y": 120, "wires": [["ex3_mqtt_out"]]},
    {"id": "ex3_mqtt_out", "type": "mqtt out", "z": "ex3_tab", "name": "Publish", "topic": "", "qos": "1", "retain": "false", "broker": "ex3_broker", "x": 350, "y": 100, "wires": []},
    {"id": "ex3_mqtt_in", "type": "mqtt in", "z": "ex3_tab", "name": "Subscribe +", "topic": "yourname/sensors/+", "qos": "1", "datatype": "auto", "broker": "ex3_broker", "nl": false, "rap": true, "rh": 0, "inputs": 0, "x": 170, "y": 200, "wires": [["ex3_switch"]]},
    {"id": "ex3_switch", "type": "switch", "z": "ex3_tab", "name": "ãƒˆãƒ”ãƒƒã‚¯åˆ†å²", "property": "topic", "propertyType": "msg", "rules": [{"t": "cont", "v": "temperature", "vt": "str"}, {"t": "cont", "v": "humidity", "vt": "str"}], "checkall": "false", "repair": false, "outputs": 2, "x": 370, "y": 200, "wires": [["ex3_debug_temp"], ["ex3_debug_humidity"]]},
    {"id": "ex3_debug_temp", "type": "debug", "z": "ex3_tab", "name": "æ¸©åº¦ãƒ‡ãƒ¼ã‚¿", "active": true, "tosidebar": true, "console": false, "tostatus": true, "complete": "payload", "targetType": "msg", "statusVal": "\"ğŸŒ¡ï¸\"", "statusType": "str", "x": 570, "y": 180, "wires": []},
    {"id": "ex3_debug_humidity", "type": "debug", "z": "ex3_tab", "name": "æ¹¿åº¦ãƒ‡ãƒ¼ã‚¿", "active": true, "tosidebar": true, "console": false, "tostatus": true, "complete": "payload", "targetType": "msg", "statusVal": "\"ğŸ’§\"", "statusType": "str", "x": 570, "y": 220, "wires": []}
]</div>
            </details>
        </div>
        
        <div class="exercise">
            <h3>æ¼”ç¿’4: IoTãƒ‡ãƒã‚¤ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ <span class="difficulty difficulty-hard">ä¸Šç´š</span></h3>
            <p><strong>ğŸ“‹ èª²é¡Œ:</strong> å®šæœŸçš„ã«ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ç™ºè¡Œã—ã€åˆ¶å¾¡ã‚³ãƒãƒ³ãƒ‰ã‚’å—ã‘ä»˜ã‘ã‚‹ä»®æƒ³IoTãƒ‡ãƒã‚¤ã‚¹ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
            
            <p><strong>ğŸ¯ è¦æ±‚ä»•æ§˜:</strong></p>
            <ul>
                <li><strong>ç™ºè¡Œ:</strong> 10ç§’ã”ã¨ã«ãƒ©ãƒ³ãƒ€ãƒ ãªæ¸©åº¦ãƒ»æ¹¿åº¦ã‚’ç™ºè¡Œ</li>
                <li>ãƒˆãƒ”ãƒƒã‚¯: <code>yourname/device001/telemetry</code></li>
                <li><strong>è³¼èª­:</strong> åˆ¶å¾¡ã‚³ãƒãƒ³ãƒ‰ï¼ˆON/OFFï¼‰ã‚’å—ä¿¡</li>
                <li>ãƒˆãƒ”ãƒƒã‚¯: <code>yourname/device001/command</code></li>
            </ul>
            
            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <p><strong>å®šæœŸç™ºè¡Œ:</strong> Inject ãƒãƒ¼ãƒ‰ã® repeat ã‚’ 10 ç§’ã«è¨­å®š</p>
                <p><strong>ãƒ©ãƒ³ãƒ€ãƒ å€¤:</strong></p>
                <div class="code-block">var temp = 20 + Math.random() * 10;
var humidity = 40 + Math.random() * 40;
msg.payload = JSON.stringify({temperature: temp.toFixed(1), humidity: Math.floor(humidity)});
return msg;</div>
            </details>
            
            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json">[
    {"id": "ex4_tab", "type": "tab", "label": "æ¼”ç¿’4"},
    {"id": "ex4_broker", "type": "mqtt-broker", "name": "Public Broker", "broker": "test.mosquitto.org", "port": "1883", "clientid": "", "autoConnect": true, "usetls": false, "protocolVersion": "4", "keepalive": "60", "cleansession": true},
    {"id": "ex4_inject", "type": "inject", "z": "ex4_tab", "name": "10ç§’ã”ã¨", "props": [{"p": "payload"}], "repeat": "10", "crontab": "", "once": false, "onceDelay": 0.1, "topic": "", "payload": "", "payloadType": "date", "x": 160, "y": 100, "wires": [["ex4_func_sensor"]]},
    {"id": "ex4_func_sensor", "type": "function", "z": "ex4_tab", "name": "ã‚»ãƒ³ã‚µãƒ¼å€¤ç”Ÿæˆ", "func": "var temp = 20 + Math.random() * 10;\nvar humidity = 40 + Math.random() * 40;\nmsg.payload = JSON.stringify({deviceId: \"device001\", temperature: parseFloat(temp.toFixed(1)), humidity: Math.floor(humidity), timestamp: new Date().toISOString()});\nmsg.topic = \"yourname/device001/telemetry\";\nreturn msg;", "outputs": 1, "timeout": 0, "noerr": 0, "initialize": "", "finalize": "", "libs": [], "x": 370, "y": 100, "wires": [["ex4_mqtt_out", "ex4_debug_send"]]},
    {"id": "ex4_mqtt_out", "type": "mqtt out", "z": "ex4_tab", "name": "Publish Telemetry", "topic": "", "qos": "1", "retain": "false", "broker": "ex4_broker", "x": 590, "y": 100, "wires": []},
    {"id": "ex4_debug_send", "type": "debug", "z": "ex4_tab", "name": "é€ä¿¡ãƒ‡ãƒ¼ã‚¿", "active": true, "tosidebar": true, "console": false, "tostatus": true, "complete": "payload", "targetType": "msg", "statusVal": "\"é€ä¿¡\"", "statusType": "str", "x": 570, "y": 140, "wires": []},
    {"id": "ex4_mqtt_in", "type": "mqtt in", "z": "ex4_tab", "name": "Subscribe Command", "topic": "yourname/device001/command", "qos": "1", "datatype": "utf8", "broker": "ex4_broker", "nl": false, "rap": true, "rh": 0, "inputs": 0, "x": 190, "y": 220, "wires": [["ex4_debug_cmd"]]},
    {"id": "ex4_debug_cmd", "type": "debug", "z": "ex4_tab", "name": "ã‚³ãƒãƒ³ãƒ‰å—ä¿¡", "active": true, "tosidebar": true, "console": false, "tostatus": true, "complete": "payload", "targetType": "msg", "statusVal": "payload", "statusType": "msg", "x": 430, "y": 220, "wires": []}
]</div>
            </details>
        </div>
        
        <h2 id="section7">âœ… 7. ã¾ã¨ã‚</h2>
        
        <div class="important">
            <p><strong>ğŸ¯ é‡è¦ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
            <ul>
                <li><strong>Pub/Sub ãƒ¢ãƒ‡ãƒ«</strong>: é€ä¿¡è€…ã¨å—ä¿¡è€…ãŒç›´æ¥æ¥ç¶šã›ãšã€ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã‚’ä»‹ã—ã¦é€šä¿¡</li>
                <li><strong>ãƒˆãƒ”ãƒƒã‚¯</strong>: éšå±¤æ§‹é€ ã§è¨­è¨ˆï¼ˆä¾‹: home/sensor/temperatureï¼‰</li>
                <li><strong>ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰</strong>: <code>+</code>ï¼ˆ1éšå±¤ï¼‰ã€<code>#</code>ï¼ˆå…¨éšå±¤ï¼‰</li>
                <li><strong>QoS</strong>: 0=æœ€å¤§1å›ã€1=æœ€ä½1å›ã€2=æ­£ç¢ºã«1å›</li>
                <li><strong>Retain</strong>: æœ€å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿æŒï¼ˆæ–°è¦è³¼èª­è€…ã«é…ä¿¡ï¼‰</li>
            </ul>
        </div>
        
        <div class="warning">
            <p><strong>âš ï¸ æ³¨æ„äº‹é …:</strong></p>
            <ul>
                <li>å…¬é–‹ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã§ã¯<strong>ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªãƒˆãƒ”ãƒƒã‚¯å</strong>ã‚’ä½¿ç”¨</li>
                <li>æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã¯<strong>èªè¨¼ãƒ»æš—å·åŒ–</strong>ã‚’è¨­å®šã—ãŸãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼ã‚’ä½¿ç”¨</li>
                <li>å¤§é‡ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç™ºè¡Œã™ã‚‹éš›ã¯<strong>QoS 0</strong>ã‚’æ¤œè¨ï¼ˆè»½é‡ï¼‰</li>
            </ul>
        </div>
        
        <h2 id="section8">ğŸ”§ 8. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
        
        <table>
            <tr><th>ç—‡çŠ¶</th><th>åŸå› </th><th>è§£æ±ºæ–¹æ³•</th></tr>
            <tr><td>æ¥ç¶šã§ããªã„</td><td>ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼è¨­å®šã®èª¤ã‚Š</td><td>Serverã€Port ã‚’ç¢ºèªã€ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ç¢ºèª</td></tr>
            <tr><td>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã‹ãªã„</td><td>ãƒˆãƒ”ãƒƒã‚¯åã®ä¸ä¸€è‡´</td><td>ç™ºè¡Œ/è³¼èª­ã®ãƒˆãƒ”ãƒƒã‚¯åã‚’æ­£ç¢ºã«ä¸€è‡´ã•ã›ã‚‹</td></tr>
            <tr><td>æ¥ç¶šãŒåˆ‡ã‚Œã‚‹</td><td>Keep Alive ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ</td><td>Keep Alive å€¤ã‚’èª¿æ•´</td></tr>
            <tr><td>é‡è¤‡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</td><td>QoS 1 ã®å†é€</td><td>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã§é‡è¤‡æ’é™¤</td></tr>
            <tr><td>å¤ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã</td><td>Retain ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</td><td>ç©ºã®Retainãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç™ºè¡Œã—ã¦ã‚¯ãƒªã‚¢</td></tr>
        </table>
        
        <h2 id="section9">ğŸ­ 9. å®Ÿå‹™æ´»ç”¨ä¾‹</h2>
        
        <h3>ã‚±ãƒ¼ã‚¹1: åˆ†æ•£ã‚»ãƒ³ã‚µãƒ¼ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</h3>
        <p>è¤‡æ•°ã®Raspberry Pi ã‹ã‚‰ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’MQTTã§åé›†ã—ã€ä¸­å¤®ã®Node-REDã§é›†ç´„ãƒ»å¯è¦–åŒ–</p>
        
        <h3>ã‚±ãƒ¼ã‚¹2: ã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ åˆ¶å¾¡</h3>
        <p>ç…§æ˜ã€ã‚¨ã‚¢ã‚³ãƒ³ã€ãƒ‰ã‚¢ãƒ­ãƒƒã‚¯ãªã©ã‚’MQTTã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</p>
        
        <h3>ã‚±ãƒ¼ã‚¹3: å·¥å ´IoT</h3>
        <p>è£½é€ æ©Ÿå™¨ã®çŠ¶æ…‹ç›£è¦–ã€äºˆçŸ¥ä¿å…¨ã®ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿åé›†</p>
        
        <h3>ã‚±ãƒ¼ã‚¹4: è»Šä¸¡è¿½è·¡ã‚·ã‚¹ãƒ†ãƒ </h3>
        <p>GPSãƒ‡ãƒ¼ã‚¿ã‚’MQTTã§é€ä¿¡ã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä½ç½®è¿½è·¡</p>
        
        <p style="margin-top: 40px;"><a href="https://nodered.org/docs/user-guide/nodes#mqtt" target="_blank">ğŸ“š Node-RED å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ - MQTT</a></p>
    </div>
    
    <script>
        document.querySelectorAll('.flow-json').forEach(function(block) {
            var btn = document.createElement('button');
            btn.className = 'copy-btn';
            btn.textContent = 'ã‚³ãƒ”ãƒ¼';
            btn.onclick = function() {
                navigator.clipboard.writeText(block.textContent).then(function() {
                    btn.textContent = 'ã‚³ãƒ”ãƒ¼å®Œäº†!';
                    setTimeout(function() { btn.textContent = 'ã‚³ãƒ”ãƒ¼'; }, 2000);
                });
            };
            block.style.position = 'relative';
            block.appendChild(btn);
        });
    </script>
    <!-- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ›ãƒ¼ãƒ ãƒœã‚¿ãƒ³ -->
    <a href="index.html" style="position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; background: linear-gradient(135deg, #42b883 0%, #35495e 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; font-size: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 1000; transition: transform 0.3s, box-shadow 0.3s;" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.4)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.3)';" title="ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸">ğŸ </a>
</body>
</html>
