<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node-RED e-mail ãƒãƒ¼ãƒ‰ã‚¬ã‚¤ãƒ‰</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.8; max-width: 1000px; margin: 0 auto; padding: 20px; background-color: #f5f5f5; color: #333; }
        h1 { color: #b92d5d; border-bottom: 3px solid #b92d5d; padding-bottom: 10px; }
        h2 { color: #d33682; margin-top: 40px; border-left: 5px solid #d33682; padding-left: 15px; }
        h3 { color: #555; margin-top: 25px; }
        h4 { color: #666; margin-top: 20px; }
        .container { background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .node-example { background-color: #2d3133; padding: 20px; border-radius: 5px; margin: 20px 0; color: white; font-family: 'Courier New', monospace; display: flex; align-items: center; flex-wrap: wrap; gap: 5px; }
        .node { display: inline-block; padding: 8px 15px; border-radius: 4px; margin: 5px; font-weight: bold; font-size: 14px; }
        .node-inject { background-color: #3fadb5; color: white; }
        .node-debug { background-color: #87a48d; color: white; }
        .node-function { background-color: #e8a658; color: white; }
        .node-change { background-color: #e7a070; color: white; }
        .node-switch { background-color: #e2d96e; color: #333; }
        .node-email-out { background-color: #c7b299; color: #333; }
        .node-email-in { background-color: #c7b299; color: #333; }
        .node-template { background-color: #e8a658; color: white; }
        .node-catch { background-color: #e8967a; color: white; }
        .arrow { color: #999; font-size: 20px; margin: 0 10px; }
        .important { background-color: #fce4ec; border-left: 4px solid #b92d5d; padding: 15px; margin: 20px 0; border-radius: 0 5px 5px 0; }
        .tip { background-color: #e8f5e9; border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 0 5px 5px 0; }
        .warning { background-color: #fff3e0; border-left: 4px solid #ff9800; padding: 15px; margin: 20px 0; border-radius: 0 5px 5px 0; }
        .code-block { background-color: #2d3133; color: #f8f8f2; padding: 15px; border-radius: 5px; margin: 15px 0; overflow-x: auto; font-family: 'Courier New', Consolas, monospace; font-size: 14px; white-space: pre; }
        .flow-json { background-color: #1a1a2e; color: #a6e22e; padding: 15px; border-radius: 5px; font-family: 'Courier New', Consolas, monospace; font-size: 12px; overflow-x: auto; white-space: pre; position: relative; max-height: 400px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #b92d5d; color: white; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .exercise { background-color: #e3f2fd; padding: 20px; border-radius: 8px; margin: 20px 0; border: 2px solid #2196f3; }
        .exercise h3 { color: #1976d2; margin-top: 0; }
        .difficulty { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 12px; font-weight: bold; margin-left: 10px; }
        .difficulty-easy { background-color: #c8e6c9; color: #2e7d32; }
        .difficulty-medium { background-color: #fff9c4; color: #f57f17; }
        .difficulty-hard { background-color: #ffcdd2; color: #c62828; }
        details { background-color: #f5f5f5; padding: 10px 15px; border-radius: 5px; margin: 10px 0; }
        details summary { cursor: pointer; font-weight: bold; color: #1976d2; }
        details[open] summary { margin-bottom: 10px; }
        .toc { background-color: #fafafa; border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin: 20px 0; }
        .toc h3 { margin-top: 0; color: #b92d5d; }
        .toc ul { list-style: none; padding-left: 0; }
        .toc li { padding: 5px 0; }
        .toc a { color: #1976d2; text-decoration: none; }
        .toc a:hover { text-decoration: underline; }
        .copy-btn { position: absolute; top: 5px; right: 5px; background-color: #666; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; }
        .copy-btn:hover { background-color: #888; }
        .node-compare { display: flex; gap: 20px; flex-wrap: wrap; margin: 20px 0; }
        .node-card { background: #f9f9f9; border: 1px solid #ddd; border-radius: 8px; padding: 15px; flex: 1; min-width: 280px; }
        .node-card h4 { margin-top: 0; color: #b92d5d; }
        .copy-button { position: absolute; top: 8px; right: 8px; padding: 6px 12px; background-color: #b92d5d; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; font-family: 'Segoe UI', sans-serif; transition: background-color 0.2s; z-index: 10; display: flex; align-items: center; gap: 4px; }
        .copy-button:hover { background-color: #9a2550; }
        .copy-button.copied { background-color: #28a745; }
        .copy-button svg { width: 14px; height: 14px; fill: currentColor; }
        .protocol-box { background: linear-gradient(135deg, #1976d2 0%, #0d47a1 100%); color: white; padding: 15px 20px; border-radius: 8px; margin: 10px 0; }
        .protocol-box h4 { margin: 0 0 10px 0; color: white; }
        .protocol-box code { background: rgba(255,255,255,0.2); padding: 2px 6px; border-radius: 3px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“§ Node-RED e-mail ãƒãƒ¼ãƒ‰ã‚¬ã‚¤ãƒ‰</h1>

        <div class="toc">
            <h3>ğŸ“š ç›®æ¬¡</h3>
            <ul>
                <li><a href="#section1">1. æ¦‚è¦</a></li>
                <li><a href="#section2">2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
                <li><a href="#section3">3. e-mailï¼ˆé€ä¿¡ï¼‰ãƒãƒ¼ãƒ‰</a></li>
                <li><a href="#section4">4. e-mail inï¼ˆå—ä¿¡ï¼‰ãƒãƒ¼ãƒ‰</a></li>
                <li><a href="#section5">5. èªè¨¼è¨­å®š</a></li>
                <li><a href="#section6">6. å®Ÿç”¨çš„ãªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³</a></li>
                <li><a href="#section7">7. æ¼”ç¿’å•é¡Œ</a></li>
                <li><a href="#section8">8. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a></li>
                <li><a href="#section9">9. ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</a></li>
                <li><a href="#section10">10. è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹</a></li>
            </ul>
        </div>

        <div class="important">
            <p><strong>ğŸ“¦ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±:</strong></p>
            <ul>
                <li><strong>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å:</strong> node-red-node-email</li>
                <li><strong>ç¨®åˆ¥:</strong> Node-REDå…¬å¼ã‚¢ãƒ‰ã‚ªãƒ³ãƒãƒ¼ãƒ‰ï¼ˆnode-red-nodesã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼‰</li>
                <li><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹:</strong> Apache-2.0</li>
                <li><strong>å†…éƒ¨åˆ©ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª:</strong> nodemailer</li>
                <li><strong>Node.jsè¦ä»¶:</strong> v18ä»¥ä¸Šï¼ˆv3.xä»¥é™ï¼‰</li>
            </ul>
        </div>

        <h2 id="section1">ğŸ“– 1. æ¦‚è¦</h2>

        <p><code>node-red-node-email</code>ã¯ã€Node-REDã‹ã‚‰ãƒ¡ãƒ¼ãƒ«ã‚’<strong>é€ä¿¡ãƒ»å—ä¿¡</strong>ã™ã‚‹ãŸã‚ã®å…¬å¼ã‚¢ãƒ‰ã‚ªãƒ³ãƒãƒ¼ãƒ‰ã§ã™ã€‚SMTP/IMAP/POP3ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«å¯¾å¿œã—ã€IoTã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ã‹ã‚‰ãƒ¡ãƒ¼ãƒ«è‡ªå‹•å‡¦ç†ã¾ã§å¹…åºƒã„ç”¨é€”ã«åˆ©ç”¨ã§ãã¾ã™ã€‚</p>

        <h3>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å«ã¾ã‚Œã‚‹ãƒãƒ¼ãƒ‰</h3>

        <div class="node-compare">
            <div class="node-card">
                <h4>ğŸ“¤ e-mailï¼ˆå‡ºåŠ›ãƒãƒ¼ãƒ‰ï¼‰</h4>
                <p>SMTPã‚’ä½¿ã£ã¦ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã™ã€‚HTMLå½¢å¼ã®ãƒ¡ãƒ¼ãƒ«ã€æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ä»˜ããƒ¡ãƒ¼ãƒ«ã«ã‚‚å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚</p>
            </div>
            <div class="node-card">
                <h4>ğŸ“¥ e-mail inï¼ˆå…¥åŠ›ãƒãƒ¼ãƒ‰ï¼‰</h4>
                <p>IMAP4ã¾ãŸã¯POP3ã§ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ã€æ–°ç€ãƒ¡ãƒ¼ãƒ«ã‚’ãƒ•ãƒ­ãƒ¼ã«æ¸¡ã—ã¾ã™ã€‚å®šæœŸçš„ãªãƒãƒ¼ãƒªãƒ³ã‚°ã§ç›£è¦–ã—ã¾ã™ã€‚</p>
            </div>
        </div>

        <h3>éƒµä¾¿ã‚·ã‚¹ãƒ†ãƒ ã«ä¾‹ãˆã‚‹ã¨</h3>
        <p>e-mailãƒãƒ¼ãƒ‰ã¯ã€Œéƒµä¾¿å±€ã€ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚</p>
        <ul>
            <li><strong>e-mailï¼ˆé€ä¿¡ï¼‰</strong>= çª“å£ã‹ã‚‰æ‰‹ç´™ã‚’æŠ•å‡½ã™ã‚‹ï¼ˆSMTPã‚µãƒ¼ãƒãƒ¼ã«ä¾é ¼ï¼‰</li>
            <li><strong>e-mail inï¼ˆå—ä¿¡ï¼‰</strong>= è‡ªåˆ†ã®éƒµä¾¿å—ã‘ã‚’å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ï¼ˆIMAP/POP3ã§ç¢ºèªï¼‰</li>
        </ul>

        <div class="node-example">
            <span class="node node-inject">inject</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">æœ¬æ–‡ä½œæˆ</span>
            <span class="arrow">â†’</span>
            <span class="node node-email-out">e-mail</span>
        </div>

        <div class="node-example">
            <span class="node node-email-in">e-mail in</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">è§£æå‡¦ç†</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">debug</span>
        </div>

        <h2 id="section2">ğŸ”§ 2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>

        <h3>æ–¹æ³•1: ãƒ‘ãƒ¬ãƒƒãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼ˆæ¨å¥¨ï¼‰</h3>
        <ol>
            <li>Node-REDã‚¨ãƒ‡ã‚£ã‚¿ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ â†’ <strong>ãƒ‘ãƒ¬ãƒƒãƒˆã®ç®¡ç†</strong></li>
            <li><strong>ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ </strong>ã‚¿ãƒ–ã‚’é¸æŠ</li>
            <li><code>node-red-node-email</code> ã‚’æ¤œç´¢</li>
            <li><strong>ãƒãƒ¼ãƒ‰ã‚’è¿½åŠ </strong>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
        </ol>

        <h3>æ–¹æ³•2: ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³</h3>
        <div class="code-block">cd ~/.node-red
npm install node-red-node-email</div>

        <p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€Node-REDã‚’å†èµ·å‹•ã™ã‚‹ã¨ãƒ‘ãƒ¬ãƒƒãƒˆã®<strong>ã€ŒSocialã€</strong>ã‚«ãƒ†ã‚´ãƒªã«ãƒãƒ¼ãƒ‰ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚</p>

        <div class="tip">
            <p><strong>ğŸ’¡ ãƒ’ãƒ³ãƒˆ:</strong> Node-RED v2.0ä»¥é™ã§ã¯ãƒ‘ãƒ¬ãƒƒãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‹ã‚‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæœ€ã‚‚ç°¡å˜ã§ã™ã€‚Node-REDã®å†èµ·å‹•ã‚‚è‡ªå‹•çš„ã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚</p>
        </div>

        <h2 id="section3">ğŸ“¤ 3. e-mailï¼ˆé€ä¿¡ï¼‰ãƒãƒ¼ãƒ‰</h2>

        <p>SMTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹å‡ºåŠ›ãƒãƒ¼ãƒ‰ã§ã™ã€‚</p>

        <h3>ãƒãƒ¼ãƒ‰è¨­å®šãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h3>

        <table>
            <tr>
                <th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
                <th>å‹</th>
                <th>èª¬æ˜</th>
            </tr>
            <tr>
                <td><strong>To</strong></td>
                <td>string</td>
                <td>å®›å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°æŒ‡å®šå¯ï¼‰</td>
            </tr>
            <tr>
                <td><strong>Server</strong></td>
                <td>string</td>
                <td>SMTPã‚µãƒ¼ãƒãƒ¼ã®ãƒ›ã‚¹ãƒˆåï¼ˆä¾‹: smtp.gmail.comï¼‰</td>
            </tr>
            <tr>
                <td><strong>Port</strong></td>
                <td>number</td>
                <td>SMTPãƒãƒ¼ãƒˆç•ªå·ï¼ˆ465: SSL, 587: STARTTLS, 25: éæš—å·åŒ–ï¼‰</td>
            </tr>
            <tr>
                <td><strong>Use Secure Connection</strong></td>
                <td>boolean</td>
                <td>SSL/TLSæ¥ç¶šã‚’ä½¿ç”¨ï¼ˆãƒãƒ¼ãƒˆ465ã®å ´åˆã¯ã‚ªãƒ³ï¼‰</td>
            </tr>
            <tr>
                <td><strong>Userid</strong></td>
                <td>string</td>
                <td>SMTPèªè¨¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td>
            </tr>
            <tr>
                <td><strong>Password</strong></td>
                <td>string</td>
                <td>SMTPèªè¨¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</td>
            </tr>
            <tr>
                <td><strong>Name</strong></td>
                <td>string</td>
                <td>ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ã®è¡¨ç¤ºå</td>
            </tr>
        </table>

        <h3>å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h3>

        <table>
            <tr>
                <th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
                <th>å‹</th>
                <th>èª¬æ˜</th>
            </tr>
            <tr>
                <td><strong>msg.to</strong></td>
                <td>string</td>
                <td>å®›å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆãƒãƒ¼ãƒ‰è¨­å®šã®å€¤ã‚’ä¸Šæ›¸ãï¼‰</td>
            </tr>
            <tr>
                <td><strong>msg.cc</strong></td>
                <td>string</td>
                <td>CCã‚¢ãƒ‰ãƒ¬ã‚¹</td>
            </tr>
            <tr>
                <td><strong>msg.bcc</strong></td>
                <td>string</td>
                <td>BCCã‚¢ãƒ‰ãƒ¬ã‚¹</td>
            </tr>
            <tr>
                <td><strong>msg.from</strong></td>
                <td>string</td>
                <td>é€ä¿¡å…ƒã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ä¸€è‡´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒå¤šã„ï¼‰</td>
            </tr>
            <tr>
                <td><strong>msg.topic</strong></td>
                <td>string</td>
                <td>ãƒ¡ãƒ¼ãƒ«ã®ä»¶åï¼ˆSubjectï¼‰</td>
            </tr>
            <tr>
                <td><strong>msg.payload</strong></td>
                <td>string / Buffer</td>
                <td>ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ï¼ˆHTMLå¯ï¼‰ã€‚Bufferã®å ´åˆã¯æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦é€ä¿¡</td>
            </tr>
            <tr>
                <td><strong>msg.plaintext</strong></td>
                <td>string</td>
                <td>payloadãŒHTMLã®å ´åˆã®ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä»£æ›¿ç‰ˆ</td>
            </tr>
            <tr>
                <td><strong>msg.replyTo</strong></td>
                <td>string</td>
                <td>è¿”ä¿¡å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹</td>
            </tr>
            <tr>
                <td><strong>msg.inReplyTo</strong></td>
                <td>string</td>
                <td>è¿”ä¿¡å…ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ID</td>
            </tr>
            <tr>
                <td><strong>msg.references</strong></td>
                <td>string</td>
                <td>ã‚¹ãƒ¬ãƒƒãƒ‰ã®å‚ç…§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ID</td>
            </tr>
            <tr>
                <td><strong>msg.headers</strong></td>
                <td>object</td>
                <td>ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ¼ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼</td>
            </tr>
            <tr>
                <td><strong>msg.priority</strong></td>
                <td>string</td>
                <td>ãƒ¡ãƒ¼ãƒ«ã®å„ªå…ˆåº¦</td>
            </tr>
            <tr>
                <td><strong>msg.attachments</strong></td>
                <td>array</td>
                <td>æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆnodemailerå½¢å¼ï¼‰</td>
            </tr>
            <tr>
                <td><strong>msg.envelope</strong></td>
                <td>object</td>
                <td>SMTP envelopeï¼ˆæ‹¡å¼µã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šç”¨ï¼‰</td>
            </tr>
        </table>

        <h3>åŸºæœ¬çš„ãªé€ä¿¡ãƒ•ãƒ­ãƒ¼ä¾‹</h3>

        <div class="node-example">
            <span class="node node-inject">ãƒ†ã‚¹ãƒˆé€ä¿¡</span>
            <span class="arrow">â†’</span>
            <span class="node node-change">ä»¶åãƒ»æœ¬æ–‡è¨­å®š</span>
            <span class="arrow">â†’</span>
            <span class="node node-email-out">e-mail</span>
        </div>

        <h4>ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡</h4>
        <div class="code-block">// Functionãƒãƒ¼ãƒ‰ã§æœ¬æ–‡ã‚’è¨­å®š
msg.to = "recipient@example.com";
msg.topic = "Node-REDã‹ã‚‰ã®ãƒ†ã‚¹ãƒˆé€šçŸ¥";
msg.payload = "ã“ã‚Œã¯Node-REDã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«ã§ã™ã€‚";
return msg;</div>

        <h4>HTMLãƒ¡ãƒ¼ãƒ«é€ä¿¡</h4>
        <div class="code-block">// HTMLãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡
msg.to = "recipient@example.com";
msg.topic = "ã‚»ãƒ³ã‚µãƒ¼ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥";
msg.payload = "&lt;h2&gt;æ¸©åº¦ã‚¢ãƒ©ãƒ¼ãƒˆ&lt;/h2&gt;" +
    "&lt;p&gt;ã‚»ãƒ³ã‚µãƒ¼ã®æ¸©åº¦ãŒé–¾å€¤ã‚’è¶…ãˆã¾ã—ãŸã€‚&lt;/p&gt;" +
    "&lt;ul&gt;" +
    "  &lt;li&gt;ç¾åœ¨å€¤: &lt;strong&gt;" + msg.temperature + "Â°C&lt;/strong&gt;&lt;/li&gt;" +
    "  &lt;li&gt;é–¾å€¤: 50Â°C&lt;/li&gt;" +
    "  &lt;li&gt;æ™‚åˆ»: " + new Date().toLocaleString('ja-JP') + "&lt;/li&gt;" +
    "&lt;/ul&gt;";
msg.plaintext = "æ¸©åº¦ã‚¢ãƒ©ãƒ¼ãƒˆ: ç¾åœ¨å€¤ " + msg.temperature + "Â°Cï¼ˆé–¾å€¤: 50Â°Cï¼‰";
return msg;</div>

        <h4>æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ä»˜ããƒ¡ãƒ¼ãƒ«é€ä¿¡</h4>
        <div class="code-block">// æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ä»˜ããƒ¡ãƒ¼ãƒ«
msg.to = "recipient@example.com";
msg.topic = "ãƒ¬ãƒãƒ¼ãƒˆæ·»ä»˜";
msg.payload = "æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã‚’æ·»ä»˜ã—ã¾ã™ã€‚";
msg.attachments = [
    {
        filename: "report.csv",
        content: "æ—¥æ™‚,æ¸©åº¦,æ¹¿åº¦\n2025-01-01 10:00,25.3,60\n2025-01-01 11:00,26.1,58",
        contentType: "text/csv"
    }
];
return msg;</div>

        <div class="tip">
            <p><strong>ğŸ’¡ ãƒ’ãƒ³ãƒˆ:</strong> <code>msg.payload</code>ã«Bufferï¼ˆãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’è¨­å®šã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦é€ä¿¡ã•ã‚Œã¾ã™ã€‚ãã®å ´åˆã€<code>msg.filename</code>ã§ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æŒ‡å®šã§ãã¾ã™ã€‚</p>
        </div>

        <h2 id="section4">ğŸ“¥ 4. e-mail inï¼ˆå—ä¿¡ï¼‰ãƒãƒ¼ãƒ‰</h2>

        <p>IMAP4ã¾ãŸã¯POP3ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã™ã‚‹å…¥åŠ›ãƒãƒ¼ãƒ‰ã§ã™ã€‚å®šæœŸçš„ã«ã‚µãƒ¼ãƒãƒ¼ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°ã—ã€æ–°ç€ãƒ¡ãƒ¼ãƒ«ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦å‡ºåŠ›ã—ã¾ã™ã€‚</p>

        <h3>ãƒãƒ¼ãƒ‰è¨­å®šãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h3>

        <table>
            <tr>
                <th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
                <th>å‹</th>
                <th>èª¬æ˜</th>
            </tr>
            <tr>
                <td><strong>Protocol</strong></td>
                <td>select</td>
                <td>å—ä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆIMAP4ã¾ãŸã¯POP3ï¼‰</td>
            </tr>
            <tr>
                <td><strong>Server</strong></td>
                <td>string</td>
                <td>å—ä¿¡ã‚µãƒ¼ãƒãƒ¼ã®ãƒ›ã‚¹ãƒˆåï¼ˆä¾‹: imap.gmail.comï¼‰</td>
            </tr>
            <tr>
                <td><strong>Port</strong></td>
                <td>number</td>
                <td>ãƒãƒ¼ãƒˆç•ªå·ï¼ˆIMAP: 993, POP3: 995ï¼‰</td>
            </tr>
            <tr>
                <td><strong>Use Secure Connection</strong></td>
                <td>boolean</td>
                <td>SSL/TLSæ¥ç¶šã‚’ä½¿ç”¨</td>
            </tr>
            <tr>
                <td><strong>Userid</strong></td>
                <td>string</td>
                <td>ãƒ¡ãƒ¼ãƒ«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td>
            </tr>
            <tr>
                <td><strong>Password</strong></td>
                <td>string</td>
                <td>ãƒ¡ãƒ¼ãƒ«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</td>
            </tr>
            <tr>
                <td><strong>Folder</strong></td>
                <td>string</td>
                <td>ç›£è¦–ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆIMAP4ã®å ´åˆã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: INBOXï¼‰</td>
            </tr>
            <tr>
                <td><strong>Disposition</strong></td>
                <td>select</td>
                <td>å—ä¿¡å¾Œã®ãƒ¡ãƒ¼ãƒ«å‡¦ç†ï¼ˆNone / Mark Read / Deleteï¼‰</td>
            </tr>
            <tr>
                <td><strong>Name</strong></td>
                <td>string</td>
                <td>ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ã®è¡¨ç¤ºå</td>
            </tr>
        </table>

        <h3>å‡ºåŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</h3>

        <table>
            <tr>
                <th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
                <th>å‹</th>
                <th>èª¬æ˜</th>
            </tr>
            <tr>
                <td><strong>msg.payload</strong></td>
                <td>string</td>
                <td>ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ï¼ˆãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰</td>
            </tr>
            <tr>
                <td><strong>msg.html</strong></td>
                <td>string</td>
                <td>HTMLå½¢å¼ã®æœ¬æ–‡ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰</td>
            </tr>
            <tr>
                <td><strong>msg.topic</strong></td>
                <td>string</td>
                <td>ãƒ¡ãƒ¼ãƒ«ã®ä»¶å</td>
            </tr>
            <tr>
                <td><strong>msg.from</strong></td>
                <td>string</td>
                <td>é€ä¿¡è€…ã‚¢ãƒ‰ãƒ¬ã‚¹</td>
            </tr>
            <tr>
                <td><strong>msg.date</strong></td>
                <td>string</td>
                <td>ãƒ¡ãƒ¼ãƒ«ã®æ—¥æ™‚</td>
            </tr>
            <tr>
                <td><strong>msg.header</strong></td>
                <td>object</td>
                <td>å®Œå…¨ãªãƒ˜ãƒƒãƒ€ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆto, ccç­‰ã‚’å«ã‚€ï¼‰</td>
            </tr>
            <tr>
                <td><strong>msg.attachments</strong></td>
                <td>array</td>
                <td>æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã®é…åˆ—</td>
            </tr>
        </table>

        <h4>æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ </h4>
        <div class="code-block">// msg.attachments[0] ã®ä¾‹
{
    "contentType": "application/pdf",
    "fileName": "document.pdf",
    "contentDisposition": "attachment",
    "transferEncoding": "base64",
    "length": 102400,
    "generatedFileName": "document.pdf",
    "content": &lt;Buffer&gt;  // ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿
}</div>

        <h3>å—ä¿¡ãƒ•ãƒ­ãƒ¼ä¾‹</h3>

        <div class="node-example">
            <span class="node node-email-in">e-mail in</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">debug</span>
        </div>

        <div class="node-example">
            <span class="node node-email-in">e-mail in</span>
            <span class="arrow">â†’</span>
            <span class="node node-switch">ä»¶åãƒ•ã‚£ãƒ«ã‚¿</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">å‡¦ç†</span>
            <span class="arrow">â†’</span>
            <span class="node node-debug">debug</span>
        </div>

        <h4>å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã®è§£æ</h4>
        <div class="code-block">// Functionãƒãƒ¼ãƒ‰ã§å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã‚’è§£æ
var subject = msg.topic;
var from = msg.from;
var body = msg.payload;
var date = msg.date;

node.warn("ä»¶å: " + subject);
node.warn("é€ä¿¡è€…: " + from);
node.warn("æ—¥æ™‚: " + date);

// æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆ
if (msg.attachments &amp;&amp; msg.attachments.length > 0) {
    msg.attachments.forEach(function(att) {
        node.warn("æ·»ä»˜: " + att.fileName + " (" + att.contentType + ")");
    });
}

return msg;</div>

        <h2 id="section5">ğŸ” 5. èªè¨¼è¨­å®š</h2>

        <h3>ä¸»è¦ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­å®š</h3>

        <div class="protocol-box">
            <h4>ğŸ“§ Gmail</h4>
            <p>é€ä¿¡: <code>smtp.gmail.com</code> ãƒãƒ¼ãƒˆ: <code>465</code>ï¼ˆSSLï¼‰</p>
            <p>å—ä¿¡: <code>imap.gmail.com</code> ãƒãƒ¼ãƒˆ: <code>993</code>ï¼ˆSSLï¼‰</p>
            <p>èªè¨¼: ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ï¼ˆ2æ®µéšèªè¨¼ã‚’æœ‰åŠ¹åŒ–ã—ãŸä¸Šã§ç”Ÿæˆï¼‰</p>
        </div>

        <div class="protocol-box">
            <h4>ğŸ“§ Outlook / Office 365</h4>
            <p>é€ä¿¡: <code>smtp.office365.com</code> ãƒãƒ¼ãƒˆ: <code>587</code>ï¼ˆSTARTTLSï¼‰</p>
            <p>å—ä¿¡: <code>outlook.office365.com</code> ãƒãƒ¼ãƒˆ: <code>993</code>ï¼ˆSSLï¼‰</p>
            <p>èªè¨¼: OAuth2.0ãŒå¿…è¦ãªå ´åˆã‚ã‚Š</p>
        </div>

        <div class="protocol-box">
            <h4>ğŸ“§ Yahoo! Mail</h4>
            <p>é€ä¿¡: <code>smtp.mail.yahoo.co.jp</code> ãƒãƒ¼ãƒˆ: <code>465</code>ï¼ˆSSLï¼‰</p>
            <p>å—ä¿¡: <code>imap.mail.yahoo.co.jp</code> ãƒãƒ¼ãƒˆ: <code>993</code>ï¼ˆSSLï¼‰</p>
        </div>

        <div class="warning">
            <p><strong>âš ï¸ Gmailã®ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨­å®šæ‰‹é †:</strong></p>
            <ol>
                <li>Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š â†’ <strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</strong></li>
                <li><strong>2æ®µéšèªè¨¼ãƒ—ãƒ­ã‚»ã‚¹</strong>ã‚’æœ‰åŠ¹åŒ–</li>
                <li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ â†’ <strong>ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</strong>ã‚’é¸æŠ</li>
                <li>ã‚¢ãƒ—ãƒªåã‚’å…¥åŠ›ã—ã¦<strong>ä½œæˆ</strong>ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                <li>ç”Ÿæˆã•ã‚ŒãŸ16æ–‡å­—ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’Node-REDã®Passwordæ¬„ã«å…¥åŠ›</li>
            </ol>
            <p><strong>æ³¨æ„:</strong> é€šå¸¸ã®Gmailãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚å¿…ãšã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <h3>IMAP vs POP3 ã®æ¯”è¼ƒ</h3>

        <table>
            <tr>
                <th>é …ç›®</th>
                <th>IMAP4</th>
                <th>POP3</th>
            </tr>
            <tr>
                <td>ãƒ¡ãƒ¼ãƒ«ä¿ç®¡</td>
                <td>ã‚µãƒ¼ãƒãƒ¼ã«æ®‹ã‚‹</td>
                <td>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¾Œã«å‰Šé™¤å¯èƒ½</td>
            </tr>
            <tr>
                <td>ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†</td>
                <td>å¯¾å¿œï¼ˆINBOXä»¥å¤–ã‚‚æŒ‡å®šå¯ï¼‰</td>
                <td>éå¯¾å¿œï¼ˆINBOXã®ã¿ï¼‰</td>
            </tr>
            <tr>
                <td>è¤‡æ•°ãƒ‡ãƒã‚¤ã‚¹</td>
                <td>åŒæœŸã•ã‚Œã‚‹</td>
                <td>åŒæœŸã•ã‚Œãªã„</td>
            </tr>
            <tr>
                <td>æ¨å¥¨ç”¨é€”</td>
                <td>ä¸€èˆ¬çš„ãªç›£è¦–ç”¨é€”</td>
                <td>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¾Œã«å‡¦ç†ã™ã‚‹å ´åˆ</td>
            </tr>
            <tr>
                <td>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ</td>
                <td>993ï¼ˆSSLï¼‰</td>
                <td>995ï¼ˆSSLï¼‰</td>
            </tr>
        </table>

        <div class="tip">
            <p><strong>ğŸ’¡ æ¨å¥¨:</strong> ç‰¹åˆ¥ãªç†ç”±ãŒãªã„é™ã‚Š<strong>IMAP4</strong>ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚ã‚µãƒ¼ãƒãƒ¼ä¸Šã®ãƒ¡ãƒ¼ãƒ«çŠ¶æ…‹ç®¡ç†ãŒå®¹æ˜“ã§ã€ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®šã‚‚å¯èƒ½ã§ã™ã€‚</p>
        </div>

        <h2 id="section6">ğŸ› ï¸ 6. å®Ÿç”¨çš„ãªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³</h2>

        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³1: IoTã‚»ãƒ³ã‚µãƒ¼ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥</h3>
        <p>ã‚»ãƒ³ã‚µãƒ¼ã®å€¤ãŒé–¾å€¤ã‚’è¶…ãˆãŸå ´åˆã«ãƒ¡ãƒ¼ãƒ«ã§é€šçŸ¥ã—ã¾ã™ã€‚</p>

        <div class="node-example">
            <span class="node node-inject">ã‚»ãƒ³ã‚µãƒ¼å€¤</span>
            <span class="arrow">â†’</span>
            <span class="node node-switch">é–¾å€¤ãƒã‚§ãƒƒã‚¯</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">ã‚¢ãƒ©ãƒ¼ãƒˆä½œæˆ</span>
            <span class="arrow">â†’</span>
            <span class="node node-email-out">e-mail</span>
        </div>

        <div class="code-block">// Functionãƒãƒ¼ãƒ‰: ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«ä½œæˆ
msg.to = "admin@example.com";
msg.topic = "[ALERT] æ¸©åº¦ç•°å¸¸æ¤œçŸ¥ - " + new Date().toLocaleString('ja-JP');
msg.payload = "&lt;h2 style='color:red'&gt;æ¸©åº¦ã‚¢ãƒ©ãƒ¼ãƒˆ&lt;/h2&gt;" +
    "&lt;p&gt;æ¤œçŸ¥æ™‚åˆ»: " + new Date().toLocaleString('ja-JP') + "&lt;/p&gt;" +
    "&lt;p&gt;ã‚»ãƒ³ã‚µãƒ¼ID: sensor-01&lt;/p&gt;" +
    "&lt;p&gt;ç¾åœ¨æ¸©åº¦: &lt;strong&gt;" + msg.payload + "Â°C&lt;/strong&gt;&lt;/p&gt;" +
    "&lt;p&gt;é–¾å€¤: 50Â°C&lt;/p&gt;" +
    "&lt;hr&gt;" +
    "&lt;p style='color:gray'&gt;ã“ã®ãƒ¡ãƒ¼ãƒ«ã¯Node-REDã‹ã‚‰è‡ªå‹•é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚&lt;/p&gt;";
return msg;</div>

        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³2: å®šæœŸãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡</h3>
        <p>å®šæœŸçš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã€ãƒ¬ãƒãƒ¼ãƒˆã¨ã—ã¦ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã—ã¾ã™ã€‚</p>

        <div class="node-example">
            <span class="node node-inject">æ¯æ—¥9:00</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">ãƒ‡ãƒ¼ã‚¿åé›†</span>
            <span class="arrow">â†’</span>
            <span class="node node-template">ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</span>
            <span class="arrow">â†’</span>
            <span class="node node-email-out">e-mail</span>
        </div>

        <div class="code-block">// Functionãƒãƒ¼ãƒ‰: æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã®æ•´å½¢
var now = new Date();
var dateStr = now.toLocaleDateString('ja-JP');

msg.to = "team@example.com";
msg.topic = "æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ - " + dateStr;

// CSVæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
var csvData = "æ™‚åˆ»,æ¸©åº¦,æ¹¿åº¦,æ°—åœ§\n";
// flow.get("dailyData") ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ä¾‹
var data = flow.get("dailyData") || [];
data.forEach(function(row) {
    csvData += row.time + "," + row.temp + "," + row.humidity + "," + row.pressure + "\n";
});

msg.payload = "æœ¬æ—¥ï¼ˆ" + dateStr + "ï¼‰ã®è¨ˆæ¸¬ãƒ¬ãƒãƒ¼ãƒˆã‚’æ·»ä»˜ã—ã¾ã™ã€‚";
msg.attachments = [{
    filename: "report_" + dateStr.replace(/\//g, '-') + ".csv",
    content: csvData,
    contentType: "text/csv"
}];

return msg;</div>

        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³3: ãƒ¡ãƒ¼ãƒ«å—ä¿¡ã«ã‚ˆã‚‹ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ</h3>
        <p>ç‰¹å®šã®ä»¶åã®ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ã¦ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p>

        <div class="node-example">
            <span class="node node-email-in">e-mail in</span>
            <span class="arrow">â†’</span>
            <span class="node node-switch">ä»¶ååˆ¤å®š</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ</span>
            <span class="arrow">â†’</span>
            <span class="node node-email-out">çµæœè¿”ä¿¡</span>
        </div>

        <div class="code-block">// Switchãƒãƒ¼ãƒ‰ã®è¨­å®š:
// msg.topic ãŒ "STATUS" ã‚’å«ã‚€ â†’ å‡ºåŠ›1
// msg.topic ãŒ "RESTART" ã‚’å«ã‚€ â†’ å‡ºåŠ›2
// ãã‚Œä»¥å¤– â†’ å‡ºåŠ›3

// Functionãƒãƒ¼ãƒ‰: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªã‚³ãƒãƒ³ãƒ‰
var status = {
    uptime: process.uptime(),
    memory: process.memoryUsage(),
    timestamp: new Date().toLocaleString('ja-JP')
};

msg.to = msg.from;  // é€ä¿¡è€…ã«è¿”ä¿¡
msg.topic = "Re: " + msg.topic;
msg.payload = "ã‚·ã‚¹ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:\n" +
    "ç¨¼åƒæ™‚é–“: " + Math.floor(status.uptime / 3600) + "æ™‚é–“\n" +
    "ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: " + Math.floor(status.memory.heapUsed / 1024 / 1024) + "MB\n" +
    "ç¢ºèªæ™‚åˆ»: " + status.timestamp;
return msg;</div>

        <h3>ãƒ‘ã‚¿ãƒ¼ãƒ³4: é€£ç¶šé€ä¿¡åˆ¶é™ï¼ˆãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆï¼‰</h3>
        <p>çŸ­æ™‚é–“ã«å¤§é‡ã®ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºç”Ÿã—ã¦ã‚‚ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚’ä¸€å®šé–“éš”ã«åˆ¶é™ã—ã¾ã™ã€‚</p>

        <div class="node-example">
            <span class="node node-inject">ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
            <span class="arrow">â†’</span>
            <span class="node node-function">é‡è¤‡ãƒã‚§ãƒƒã‚¯</span>
            <span class="arrow">â†’</span>
            <span class="node node-email-out">e-mail</span>
        </div>

        <div class="code-block">// Functionãƒãƒ¼ãƒ‰: 5åˆ†é–“ã«1å›ã®ã¿é€ä¿¡
var lastSent = context.get("lastSent") || 0;
var now = Date.now();
var interval = 5 * 60 * 1000; // 5åˆ†

if (now - lastSent > interval) {
    context.set("lastSent", now);
    msg.to = "admin@example.com";
    msg.topic = "[ALERT] ç•°å¸¸æ¤œçŸ¥";
    msg.payload = "ç•°å¸¸ãŒæ¤œçŸ¥ã•ã‚Œã¾ã—ãŸã€‚\næ™‚åˆ»: " + new Date().toLocaleString('ja-JP');
    return msg;
} else {
    // åˆ¶é™ä¸­ã¯é€ä¿¡ã—ãªã„
    return null;
}</div>

        <h2 id="section7">ğŸ“ 7. æ¼”ç¿’å•é¡Œ</h2>

        <div class="exercise">
            <h3>æ¼”ç¿’1: ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡<span class="difficulty difficulty-easy">åˆç´š</span></h3>

            <p><strong>èª²é¡Œ:</strong></p>
            <p>Injectãƒãƒ¼ãƒ‰ã®ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã€ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>

            <p><strong>è¦ä»¶:</strong></p>
            <ul>
                <li>Changeãƒãƒ¼ãƒ‰ã§ä»¶åã¨æœ¬æ–‡ã‚’è¨­å®šã™ã‚‹</li>
                <li>ä»¶å: ã€ŒNode-RED ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«ã€</li>
                <li>æœ¬æ–‡: ã€Œã“ã®ãƒ¡ãƒ¼ãƒ«ã¯Node-REDã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã§ã™ã€‚é€ä¿¡æ™‚åˆ»: [ç¾åœ¨æ™‚åˆ»]ã€</li>
                <li>å®›å…ˆã¯e-mailãƒãƒ¼ãƒ‰ã®è¨­å®šç”»é¢ã§æŒ‡å®šã™ã‚‹</li>
            </ul>

            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <ul>
                    <li>Changeãƒãƒ¼ãƒ‰ã§<code>msg.topic</code>ã«ä»¶åã‚’è¨­å®š</li>
                    <li>Changeãƒãƒ¼ãƒ‰ã§<code>msg.payload</code>ã«æœ¬æ–‡ã‚’è¨­å®š</li>
                    <li>e-mailãƒãƒ¼ãƒ‰ã®Toæ¬„ã«å®›å…ˆã‚’è¨­å®š</li>
                    <li>Server, Port, Userid, Passwordã‚’æ­£ã—ãè¨­å®š</li>
                </ul>
            </details>

            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json"><button class="copy-button" onclick="copyCode(this)"><svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>Copy</button>[
    {
        "id": "email_ex1_inject",
        "type": "inject",
        "name": "ãƒ†ã‚¹ãƒˆé€ä¿¡",
        "props": [],
        "repeat": "",
        "wires": [["email_ex1_change"]]
    },
    {
        "id": "email_ex1_change",
        "type": "change",
        "name": "ä»¶åãƒ»æœ¬æ–‡è¨­å®š",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Node-RED ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$join(['ã“ã®ãƒ¡ãƒ¼ãƒ«ã¯Node-REDã‹ã‚‰é€ä¿¡ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã§ã™ã€‚é€ä¿¡æ™‚åˆ»: ', $now()])",
                "tot": "jsonata"
            }
        ],
        "wires": [["email_ex1_send"]]
    },
    {
        "id": "email_ex1_send",
        "type": "e-mail",
        "name": "ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡",
        "server": "smtp.gmail.com",
        "port": "465",
        "secure": true,
        "tls": true,
        "dname": "",
        "to": "your-email@example.com",
        "wires": []
    }
]</div>
            </details>
        </div>

        <div class="exercise">
            <h3>æ¼”ç¿’2: é–¾å€¤ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥<span class="difficulty difficulty-medium">ä¸­ç´š</span></h3>

            <p><strong>èª²é¡Œ:</strong></p>
            <p>æ¸©åº¦ã‚»ãƒ³ã‚µãƒ¼ã®å€¤ãŒè¨­å®šã—ãŸé–¾å€¤ã‚’è¶…ãˆãŸå ´åˆã«HTMLãƒ¡ãƒ¼ãƒ«ã§é€šçŸ¥ã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>

            <p><strong>è¦ä»¶:</strong></p>
            <ul>
                <li>Injectãƒãƒ¼ãƒ‰ã§ãƒ©ãƒ³ãƒ€ãƒ ãªæ¸©åº¦å€¤ï¼ˆ20ã€œ60ï¼‰ã‚’ç”Ÿæˆ</li>
                <li>Switchãƒãƒ¼ãƒ‰ã§50Â°Cä»¥ä¸Šã‚’æ¤œçŸ¥</li>
                <li>Functionãƒãƒ¼ãƒ‰ã§HTMLãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã‚’ç”Ÿæˆ</li>
                <li>ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«æ¸©åº¦å€¤ã¨æ¤œçŸ¥æ™‚åˆ»ã‚’å«ã‚ã‚‹</li>
                <li>5åˆ†é–“ã«1å›ã®ã¿é€ä¿¡ã™ã‚‹ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã‚’å®Ÿè£…</li>
            </ul>

            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <ul>
                    <li>Injectãƒãƒ¼ãƒ‰ã®<code>msg.payload</code>ã‚’JSONataå¼ã§<code>$floor($random() * 40 + 20)</code>ã«è¨­å®š</li>
                    <li>Switchãƒãƒ¼ãƒ‰ã§<code>msg.payload >= 50</code>ã‚’æ¡ä»¶ã«ã™ã‚‹</li>
                    <li>Functionãƒãƒ¼ãƒ‰ã§<code>context.get("lastSent")</code>ã§ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆåˆ¶å¾¡</li>
                    <li>HTMLæœ¬æ–‡ã§ã¯<code>&lt;h2&gt;</code>ã‚„<code>&lt;strong&gt;</code>ã‚¿ã‚°ã§è¦–èªæ€§ã‚’é«˜ã‚ã‚‹</li>
                </ul>
            </details>

            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json"><button class="copy-button" onclick="copyCode(this)"><svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>Copy</button>[
    {
        "id": "email_ex2_inject",
        "type": "inject",
        "name": "ãƒ©ãƒ³ãƒ€ãƒ æ¸©åº¦",
        "props": [{"p": "payload"}],
        "payload": "$floor($random() * 40 + 20)",
        "payloadType": "jsonata",
        "repeat": "10",
        "wires": [["email_ex2_switch"]]
    },
    {
        "id": "email_ex2_switch",
        "type": "switch",
        "name": "50Â°Cä»¥ä¸Š?",
        "property": "payload",
        "rules": [{"t": "gte", "v": "50", "vt": "num"}],
        "wires": [["email_ex2_func"]]
    },
    {
        "id": "email_ex2_func",
        "type": "function",
        "name": "ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«ä½œæˆ",
        "func": "var lastSent = context.get('lastSent') || 0;\nvar now = Date.now();\nvar interval = 5 * 60 * 1000;\n\nif (now - lastSent > interval) {\n    context.set('lastSent', now);\n    var temp = msg.payload;\n    msg.to = 'admin@example.com';\n    msg.topic = '[ALERT] æ¸©åº¦ç•°å¸¸: ' + temp + 'Â°C';\n    msg.payload = '<h2 style=\"color:red\">æ¸©åº¦ã‚¢ãƒ©ãƒ¼ãƒˆ</h2>' +\n        '<p>ã‚»ãƒ³ã‚µãƒ¼ã®æ¸©åº¦ãŒé–¾å€¤ã‚’è¶…ãˆã¾ã—ãŸã€‚</p>' +\n        '<ul>' +\n        '<li>ç¾åœ¨æ¸©åº¦: <strong>' + temp + 'Â°C</strong></li>' +\n        '<li>é–¾å€¤: 50Â°C</li>' +\n        '<li>æ¤œçŸ¥æ™‚åˆ»: ' + new Date().toLocaleString('ja-JP') + '</li>' +\n        '</ul>' +\n        '<hr><p style=\"color:gray\">ã“ã®ãƒ¡ãƒ¼ãƒ«ã¯Node-REDã‹ã‚‰è‡ªå‹•é€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>';\n    return msg;\n}\nreturn null;",
        "outputs": 1,
        "wires": [["email_ex2_send"]]
    },
    {
        "id": "email_ex2_send",
        "type": "e-mail",
        "name": "ã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡",
        "server": "smtp.gmail.com",
        "port": "465",
        "secure": true,
        "tls": true,
        "to": "admin@example.com",
        "wires": []
    }
]</div>
            </details>
        </div>

        <div class="exercise">
            <h3>æ¼”ç¿’3: ãƒ¡ãƒ¼ãƒ«å—ä¿¡ã«ã‚ˆã‚‹æ©Ÿå™¨åˆ¶å¾¡<span class="difficulty difficulty-hard">ä¸Šç´š</span></h3>

            <p><strong>èª²é¡Œ:</strong></p>
            <p>ç‰¹å®šã®ä»¶åã®ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ã¦æ©Ÿå™¨ã®æ“ä½œã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦å‡¦ç†ã—ã€çµæœã‚’è¿”ä¿¡ã™ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>

            <p><strong>è¦ä»¶:</strong></p>
            <ul>
                <li>e-mail inãƒãƒ¼ãƒ‰ã§ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡</li>
                <li>ä»¶åã«ã€ŒSTATUSã€ã‚’å«ã‚€ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ãŸã‚‰ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’è¿”ä¿¡</li>
                <li>ä»¶åã«ã€ŒREPORTã€ã‚’å«ã‚€ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ãŸã‚‰ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã‚’CSVã§è¿”ä¿¡</li>
                <li>ä¸Šè¨˜ä»¥å¤–ã®ãƒ¡ãƒ¼ãƒ«ã¯ç„¡è¦–ã™ã‚‹</li>
                <li>è¿”ä¿¡å…ˆã¯å—ä¿¡ãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡è€…ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã™ã‚‹</li>
            </ul>

            <details>
                <summary>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</summary>
                <ul>
                    <li>Switchãƒãƒ¼ãƒ‰ã§<code>msg.topic</code>ã«å¯¾ã—ã¦ã€Œcontainsã€æ¡ä»¶ã‚’ä½¿ç”¨</li>
                    <li><code>msg.from</code>ã‚’<code>msg.to</code>ã«ã‚³ãƒ”ãƒ¼ã—ã¦è¿”ä¿¡å…ˆã‚’è¨­å®š</li>
                    <li>CSVãƒ‡ãƒ¼ã‚¿ã¯<code>msg.attachments</code>ã«è¨­å®šã™ã‚‹</li>
                    <li><code>process.uptime()</code>ã‚„<code>process.memoryUsage()</code>ã§ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‚’å–å¾—</li>
                </ul>
            </details>

            <details>
                <summary>âœ… è§£ç­”ä¾‹ãƒ•ãƒ­ãƒ¼</summary>
                <div class="flow-json"><button class="copy-button" onclick="copyCode(this)"><svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>Copy</button>[
    {
        "id": "email_ex3_in",
        "type": "e-mail in",
        "name": "ã‚³ãƒãƒ³ãƒ‰å—ä¿¡",
        "protocol": "IMAP",
        "server": "imap.gmail.com",
        "port": "993",
        "secure": true,
        "useSSL": true,
        "disposition": "Read",
        "wires": [["email_ex3_switch"]]
    },
    {
        "id": "email_ex3_switch",
        "type": "switch",
        "name": "ã‚³ãƒãƒ³ãƒ‰åˆ¤å®š",
        "property": "topic",
        "rules": [
            {"t": "cont", "v": "STATUS", "vt": "str"},
            {"t": "cont", "v": "REPORT", "vt": "str"}
        ],
        "checkall": "false",
        "wires": [["email_ex3_status"], ["email_ex3_report"]]
    },
    {
        "id": "email_ex3_status",
        "type": "function",
        "name": "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¿”ä¿¡",
        "func": "var uptime = process.uptime();\nvar hours = Math.floor(uptime / 3600);\nvar mins = Math.floor((uptime % 3600) / 60);\nvar mem = process.memoryUsage();\n\nmsg.to = msg.from;\nmsg.topic = 'Re: ' + msg.topic;\nmsg.payload = 'ã‚·ã‚¹ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ\\n' +\n    '========================\\n' +\n    'ç¨¼åƒæ™‚é–“: ' + hours + 'æ™‚é–“' + mins + 'åˆ†\\n' +\n    'ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ' + Math.floor(mem.heapUsed / 1024 / 1024) + 'MB / ' + Math.floor(mem.heapTotal / 1024 / 1024) + 'MB\\n' +\n    'ç¢ºèªæ™‚åˆ»: ' + new Date().toLocaleString('ja-JP');\nreturn msg;",
        "wires": [["email_ex3_send"]]
    },
    {
        "id": "email_ex3_report",
        "type": "function",
        "name": "ãƒ¬ãƒãƒ¼ãƒˆè¿”ä¿¡",
        "func": "var data = flow.get('sensorData') || [\n    {time: '10:00', temp: 25.3, humidity: 60},\n    {time: '11:00', temp: 26.1, humidity: 58},\n    {time: '12:00', temp: 27.5, humidity: 55}\n];\n\nvar csv = 'æ™‚åˆ»,æ¸©åº¦,æ¹¿åº¦\\n';\ndata.forEach(function(row) {\n    csv += row.time + ',' + row.temp + ',' + row.humidity + '\\n';\n});\n\nmsg.to = msg.from;\nmsg.topic = 'Re: ' + msg.topic;\nmsg.payload = 'è¨ˆæ¸¬ãƒ‡ãƒ¼ã‚¿ãƒ¬ãƒãƒ¼ãƒˆã‚’æ·»ä»˜ã—ã¾ã™ã€‚';\nmsg.attachments = [{\n    filename: 'report_' + new Date().toISOString().slice(0,10) + '.csv',\n    content: csv,\n    contentType: 'text/csv'\n}];\nreturn msg;",
        "wires": [["email_ex3_send"]]
    },
    {
        "id": "email_ex3_send",
        "type": "e-mail",
        "name": "è¿”ä¿¡é€ä¿¡",
        "server": "smtp.gmail.com",
        "port": "465",
        "secure": true,
        "tls": true,
        "wires": []
    }
]</div>
            </details>
        </div>

        <h2 id="section8">ğŸ”§ 8. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>

        <table>
            <tr>
                <th>å•é¡Œ</th>
                <th>åŸå› </th>
                <th>è§£æ±ºæ–¹æ³•</th>
            </tr>
            <tr>
                <td>ãƒ¡ãƒ¼ãƒ«ãŒé€ä¿¡ã•ã‚Œãªã„</td>
                <td>SMTPèªè¨¼ã‚¨ãƒ©ãƒ¼</td>
                <td>ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆGmailï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†ç¢ºèªã™ã‚‹</td>
            </tr>
            <tr>
                <td>ã€ŒConnection refusedã€ã‚¨ãƒ©ãƒ¼</td>
                <td>ã‚µãƒ¼ãƒãƒ¼ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒãƒ¼ãƒˆç•ªå·ãŒé–“é•ã„</td>
                <td>æ­£ã—ã„ã‚µãƒ¼ãƒãƒ¼åãƒ»ãƒãƒ¼ãƒˆç•ªå·ã‚’è¨­å®šã™ã‚‹ï¼ˆGmailé€ä¿¡: smtp.gmail.com:465ï¼‰</td>
            </tr>
            <tr>
                <td>ã€ŒAuthentication failedã€ã‚¨ãƒ©ãƒ¼</td>
                <td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé€šå¸¸ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</td>
                <td>Gmailã®å ´åˆã¯ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¦ä½¿ç”¨ã™ã‚‹</td>
            </tr>
            <tr>
                <td>ãƒ¡ãƒ¼ãƒ«å—ä¿¡ãŒå‹•ä½œã—ãªã„</td>
                <td>IMAPãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹</td>
                <td>ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­å®šã§IMAP/POP3ã‚¢ã‚¯ã‚»ã‚¹ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹</td>
            </tr>
            <tr>
                <td>SSL/TLSæ¥ç¶šã‚¨ãƒ©ãƒ¼</td>
                <td>ãƒãƒ¼ãƒˆã¨SSLè¨­å®šã®ä¸ä¸€è‡´</td>
                <td>ãƒãƒ¼ãƒˆ465ã¯SSL=ONã€ãƒãƒ¼ãƒˆ587ã¯SSL=OFFï¼ˆSTARTTLSãŒè‡ªå‹•ä½¿ç”¨ã•ã‚Œã‚‹ï¼‰</td>
            </tr>
            <tr>
                <td>æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒå±Šã‹ãªã„</td>
                <td>attachmentsã®å½¢å¼ãŒä¸æ­£</td>
                <td>nodemailerå½¢å¼ï¼ˆfilename, content, contentTypeï¼‰ã§æŒ‡å®šã™ã‚‹</td>
            </tr>
            <tr>
                <td>HTMLãƒ¡ãƒ¼ãƒ«ãŒãƒ†ã‚­ã‚¹ãƒˆã§è¡¨ç¤ºã•ã‚Œã‚‹</td>
                <td>Content-TypeãŒè¨­å®šã•ã‚Œã¦ã„ãªã„</td>
                <td>msg.payloadã«HTMLã‚’è¨­å®šã™ã‚‹ã¨è‡ªå‹•çš„ã«HTMLå½¢å¼ã§é€ä¿¡ã•ã‚Œã‚‹</td>
            </tr>
            <tr>
                <td>å—ä¿¡ãƒãƒ¼ãƒªãƒ³ã‚°ãŒé »ç¹ã™ãã‚‹</td>
                <td>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š</td>
                <td>e-mail inãƒãƒ¼ãƒ‰ã®è¨­å®šã§ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ã‚’èª¿æ•´ã™ã‚‹</td>
            </tr>
            <tr>
                <td>ãƒãƒ¼ãƒ‰ãŒãƒ‘ãƒ¬ãƒƒãƒˆã«è¡¨ç¤ºã•ã‚Œãªã„</td>
                <td>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¤±æ•—ã¾ãŸã¯Node-REDæœªå†èµ·å‹•</td>
                <td>npm installã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèªã—ã€Node-REDã‚’å†èµ·å‹•ã™ã‚‹</td>
            </tr>
            <tr>
                <td>OAuth2ã‚¨ãƒ©ãƒ¼ï¼ˆOutlookï¼‰</td>
                <td>åŸºæœ¬èªè¨¼ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹</td>
                <td>OAuth2.0èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’msgçµŒç”±ã§æ¸¡ã™è¨­å®šã‚’è¡Œã†</td>
            </tr>
        </table>

        <h2 id="section9">ğŸ“ 9. ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h2>

        <div class="tip">
            <p><strong>âœ… æ¨å¥¨äº‹é …:</strong></p>
            <ul>
                <li><strong>ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä½¿ç”¨:</strong> Gmailç­‰ã§ã¯é€šå¸¸ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ã¯ãªãã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹</li>
                <li><strong>ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã®å®Ÿè£…:</strong> ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ã«ã¯å¿…ãšé€ä¿¡é–“éš”åˆ¶é™ã‚’è¨­ã‘ã¦å¤§é‡é€ä¿¡ã‚’é˜²ã</li>
                <li><strong>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°:</strong> Catchãƒãƒ¼ãƒ‰ã‚’æ¥ç¶šã—ã¦ãƒ¡ãƒ¼ãƒ«é€ä¿¡å¤±æ•—æ™‚ã®ãƒªãƒˆãƒ©ã‚¤ã‚„é€šçŸ¥ã‚’å®Ÿè£…ã™ã‚‹</li>
                <li><strong>ä»¶åã®æ˜ç¢ºåŒ–:</strong> è‡ªå‹•é€ä¿¡ãƒ¡ãƒ¼ãƒ«ã«ã¯[NODE-RED]ç­‰ã®æ¥é ­è¾ã‚’ä»˜ã‘ã¦è­˜åˆ¥ã—ã‚„ã™ãã™ã‚‹</li>
                <li><strong>HTMLã¨ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ä¸¡æ–¹:</strong> HTMLãƒ¡ãƒ¼ãƒ«é€ä¿¡æ™‚ã¯<code>msg.plaintext</code>ã‚‚è¨­å®šã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã®ã¿å¯¾å¿œã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é…æ…®ã™ã‚‹</li>
                <li><strong>IMAPã®ä½¿ç”¨:</strong> å—ä¿¡ã«ã¯POP3ã‚ˆã‚ŠIMAPã‚’æ¨å¥¨ï¼ˆãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†ã€çŠ¶æ…‹åŒæœŸãŒå¯èƒ½ï¼‰</li>
            </ul>
        </div>

        <div class="warning">
            <p><strong>âš ï¸ æ³¨æ„äº‹é …:</strong></p>
            <ul>
                <li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£:</strong> ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯Node-REDã®èªè¨¼æƒ…å ±ç®¡ç†ï¼ˆcredentialsï¼‰ã§å®‰å…¨ã«ä¿ç®¡ã•ã‚Œã‚‹ã€‚ãƒ•ãƒ­ãƒ¼ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ™‚ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å«ã¾ã‚Œãªã„</li>
                <li><strong>é€ä¿¡åˆ¶é™:</strong> Gmailã®SMTPã«ã¯1æ—¥ã‚ãŸã‚Šã®é€ä¿¡æ•°åˆ¶é™ï¼ˆ500é€š/æ—¥ï¼‰ãŒã‚ã‚‹ãŸã‚ã€å¤§é‡é€ä¿¡ã«ã¯å‘ã‹ãªã„</li>
                <li><strong>ãƒãƒ¼ãƒªãƒ³ã‚°è² è·:</strong> e-mail inãƒãƒ¼ãƒ‰ã®ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”ã‚’çŸ­ãã—ã™ãã‚‹ã¨ã‚µãƒ¼ãƒãƒ¼ã«è² è·ãŒã‹ã‹ã‚‹ã€‚æœ€ä½30ç§’ä»¥ä¸Šã‚’æ¨å¥¨</li>
                <li><strong>æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º:</strong> å¤§ããªæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼ã®åˆ¶é™ï¼ˆé€šå¸¸25MBï¼‰ã«æ³¨æ„ã™ã‚‹</li>
                <li><strong>ã‚¹ãƒ‘ãƒ åˆ¤å®š:</strong> è‡ªå‹•é€ä¿¡ãƒ¡ãƒ¼ãƒ«ã¯ã‚¹ãƒ‘ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«å¼•ã£ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚‹ã€‚é€ä¿¡å…ƒã‚¢ãƒ‰ãƒ¬ã‚¹ã¨SPF/DKIMè¨­å®šã‚’ç¢ºèªã™ã‚‹</li>
            </ul>
        </div>

        <h2 id="section10">ğŸ”— 10. è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹</h2>

        <ul>
            <li><a href="https://flows.nodered.org/node/node-red-node-email" target="_blank">Node-RED Flow Library: node-red-node-email</a></li>
            <li><a href="https://github.com/node-red/node-red-nodes/tree/master/social/email" target="_blank">GitHub ãƒªãƒã‚¸ãƒˆãƒªï¼ˆnode-red-nodes/social/emailï¼‰</a></li>
            <li><a href="https://www.npmjs.com/package/node-red-node-email" target="_blank">npm: node-red-node-email</a></li>
            <li><a href="https://nodemailer.com/" target="_blank">Nodemailer ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆå†…éƒ¨åˆ©ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰</a></li>
            <li><a href="nodered-function-node-guide.html">Function ãƒãƒ¼ãƒ‰ã‚¬ã‚¤ãƒ‰</a></li>
            <li><a href="nodered-inject-node-guide.html">Inject ãƒãƒ¼ãƒ‰ã‚¬ã‚¤ãƒ‰</a></li>
            <li><a href="nodered-catch-node-guide.html">Catch ãƒãƒ¼ãƒ‰ã‚¬ã‚¤ãƒ‰</a></li>
        </ul>

        <a href="index.html" style="position: fixed; bottom: 20px; right: 20px; background-color: #b92d5d; color: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; font-size: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); z-index: 1000;" title="ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹">ğŸ </a>
    </div>

    <script>
        function copyCode(button) {
            const codeBlock = button.parentElement;
            const code = codeBlock.textContent.replace('Copy', '').trim();

            navigator.clipboard.writeText(code).then(function() {
                button.classList.add('copied');
                button.innerHTML = '<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>Copied!';
                setTimeout(function() {
                    button.classList.remove('copied');
                    button.innerHTML = '<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>Copy';
                }, 2000);
            });
        }
    </script>
</body>
</html>
